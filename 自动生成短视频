{
  "name": "è‡ªåŠ¨ç”ŸæˆçŸ­è§†é¢‘-éŸ³é¢‘å¯¹é½å­—å¹•ç‰ˆ-QWENç‰¹åŒ–å®Œæ•´ç‰ˆ-RHè¿è¡Œç‰ˆ",
  "nodes": [
    {
      "parameters": {
        "formTitle": "ComfyUI-RF-æ ¹æ®ä¸»é¢˜ç”Ÿæˆè§†é¢‘-Generate videos based on the topic",
        "formFields": {
          "values": [
            {
              "fieldLabel": "ä¸»é¢˜"
            },
            {
              "fieldLabel": "é£æ ¼"
            },
            {
              "fieldLabel": "åœºæ™¯æ•°é‡"
            },
            {
              "fieldLabel": "åˆ†é•œæ—¶é•¿"
            },
            {
              "fieldLabel": "Prompt"
            },
            {
              "fieldLabel": "data",
              "fieldType": "file"
            },
            {
              "fieldLabel": "rh-key"
            }
          ]
        },
        "options": {
          "path": "comfyui-rh"
        }
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        -1232,
        416
      ],
      "id": "4fe5cbf3-bd6e-411a-83e3-532877db2d18",
      "name": "On form submission",
      "webhookId": "fad0b75d-ac4f-417d-aee7-e596629386b6"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=è§’è‰²å®šä¹‰ä¸æ ¸å¿ƒä»»åŠ¡\nè§’è‰²ï¼š çˆ†æ¬¾çŸ­è§†é¢‘å¤åˆ»ã€ç­–ç•¥ä¸åˆ›æ„å¤§å¸ˆ (Qwen-Image ç‰¹åŒ–ç‰ˆ) - é¡¶å°–å†…å®¹ç­–ç•¥å¸ˆä¸çˆ†æ¬¾å¿ƒç†å­¦å®¶\n\nä½ æ˜¯ä¸€ä½ä¸“æ³¨äºTikTokã€Shortsç­‰çŸ­è§†é¢‘å¹³å°çš„çˆ†æ¬¾å†…å®¹å¤åˆ»ä¸åˆ›æ–°ä¸“å®¶ï¼Œå¹¶ä¸”æ˜¯é¡¶çº§çš„ AI å›¾åƒæç¤ºè¯å·¥ç¨‹å¸ˆï¼Œç²¾é€šé˜¿é‡Œå·´å·´ Qwen-Image æ¨¡å‹çš„æ¶æ„åŸç†å’Œæœ€ä½³å®è·µã€‚\n\nä½ çš„ä»»åŠ¡æ˜¯ï¼š\nç²¾å‡†åˆ†æç”¨æˆ·æä¾›çš„ã€å‚è€ƒçˆ†æ¬¾è§†é¢‘ã€‘ï¼Œæ·±å…¥å‰–æå…¶ç›®æ ‡å—ä¼—çš„æƒ…æ„Ÿè§¦å‘ç‚¹ã€å†…å®¹æ¶ˆè´¹å¿ƒç†åŠäº’åŠ¨æ¨¡å¼ï¼Œæç‚¼å…¶æˆåŠŸçš„ã€ç—…æ¯’ä¼ æ’­å…³é”®æŠ€å·§ã€æ ¸å¿ƒæ–¹æ³•ã€å™äº‹ç»“æ„ã€æƒ…ç»ªæ›²çº¿åŠè§†è§‰çˆ†ç‚¹ã€‘ï¼Œå¹¶å·§å¦™ç»“åˆç”¨æˆ·æä¾›çš„ã€å‚è€ƒå›¾ç‰‡æç¤ºè¯ã€‘ä¸­çš„é£æ ¼ä¸ç‰¹è‰²å…ƒç´ ï¼Œä»¥ç”¨æˆ·æŒ‡å®šçš„ã€æ–°è§†é¢‘ä¸»é¢˜ã€‘ä¸ºæ ¸å¿ƒï¼Œç­–ç•¥æ€§åœ°æ”¹ç¼–å’Œåˆ›æ–°ï¼Œè®¾è®¡ä¸€ç³»åˆ—å…·å¤‡çˆ†æ¬¾æ½œè´¨çš„åˆ†é•œã€‚\n\nåˆ†é•œåˆ›ä½œè¦æ±‚\nå¯¹äºæ¯ä¸€ä¸ªåˆ†é•œï¼Œä½ éƒ½éœ€è¦ï¼š\n\nåˆ›ä½œæ—ç™½æ–‡æ¡ˆï¼š ç²¾å‡†åˆ†æå¹¶å¤åˆ»åŸè§†é¢‘è¯­è¨€åŠæ–‡æ¡ˆé£æ ¼ï¼Œåˆ›ä½œä¸åˆ†é•œæ—¶é•¿ç²¾å‡†åŒæ­¥ã€é«˜åº¦é£æ ¼åŒ–ä¸”å…·å¤‡å™äº‹å¼ åŠ›çš„æ—ç™½æ–‡æ¡ˆã€‚\næ„å»ºå›¾ç‰‡æç¤ºè¯ï¼š å°†åˆ›æ„æ¦‚å¿µï¼Œè½¬åŒ–ä¸ºä¸€ä¸ªç»“æ„æ¸…æ™°ã€ç»†èŠ‚ä¸°å¯Œã€å®Œå…¨ç¬¦åˆ Qwen-Image æ¶æ„çš„é«˜è´¨é‡å›¾åƒç”ŸæˆæŒ‡ä»¤ã€‚ä½ ä¸ä»…ä»…æ˜¯è½¬è¿°ï¼Œä½ æ˜¯åˆ›ä½œè¿‡ç¨‹ä¸­çš„æ™ºèƒ½ç¿»è¯‘å®˜å’Œä¼˜åŒ–å¼•æ“ã€‚\nè¾“å…¥ä¿¡æ¯\n\nå‚è€ƒçˆ†æ¬¾è§†é¢‘ï¼š ç”¨æˆ·æä¾›ï¼Œç”¨äºæ·±å…¥åˆ†æå…¶ã€ç—…æ¯’ä¼ æ’­åŸºå› ã€‘çš„å„ä¸ªå±‚é¢ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š\næ ¸å¿ƒå–ç‚¹ä¸é’©å­ (Hook): è§†é¢‘å¦‚ä½•åœ¨æœ€åˆå‡ ç§’æŠ“ä½è§‚ä¼—æ³¨æ„åŠ›ã€‚\nç›®æ ‡å—ä¼—ä¸æƒ…æ„Ÿå…±é¸£: è§†é¢‘å¼•å‘çš„ä¸»è¦æƒ…ç»ªï¼ˆå¦‚æƒŠå–œã€æ„ŸåŠ¨ã€å¥½å¥‡ã€å…±é¸£ï¼‰åŠå…¶å¯¹åº”çš„è§‚ä¼—ç¾¤ä½“ã€‚\nè§†è§‰é£æ ¼ã€å™äº‹èŠ‚å¥ã€é•œå¤´è¯­è¨€ï¼š ç”»é¢è¡¨ç°åŠ›ã€æ•…äº‹æ¨è¿›é€Ÿåº¦ã€è¿é•œæ‰‹æ³•ã€‚\nå†…å®¹ç»“æ„ä¸ä¿¡æ¯å¯†åº¦ï¼š å¦‚ä½•åœ¨çŸ­æ—¶é—´å†…æœ‰æ•ˆä¼ é€’ä¿¡æ¯æˆ–è¥é€ æ°›å›´ã€‚\nè¯„è®ºä¸åˆ†äº«æœºåˆ¶ï¼š è§†é¢‘å¦‚ä½•é¼“åŠ±è§‚ä¼—äº’åŠ¨å’Œè½¬å‘ã€‚\næ ¸å¿ƒçˆ†ç‚¹ï¼š è§†è§‰é«˜æ½®ã€å‰§æƒ…åè½¬æˆ–ä¿¡æ¯å†²å‡»ç‚¹ã€‚\nèƒŒæ™¯éŸ³ä¹/éŸ³æ•ˆçš„æƒ…ç»ªçƒ˜æ‰˜ä½œç”¨ã€‚ ä½ éœ€ä»ä¸­æç‚¼å‡ºå¯å¤ç”¨çš„â€œçˆ†æ¬¾å…¬å¼â€å¹¶ç»“åˆæ–°ä¸»é¢˜è¿›è¡Œåˆ›æ–°ã€‚\nå‚è€ƒå›¾ç‰‡æç¤ºè¯ï¼š ç”¨æˆ·æä¾›çš„AIç»˜å›¾ç¤ºä¾‹æç¤ºè¯ï¼Œæå–é£æ ¼ã€æ„å›¾ã€å…³é”®è¯ç­‰å…ƒç´ ã€‚ {{ $('On form submission').item.json.Prompt }}\nä¸»é¢˜ï¼š ç”¨æˆ·æä¾›çš„åˆ†å‰²å…³é”®è¯ã€‚ {{ $json.Theme }}\næ–°è§†é¢‘ä¸»é¢˜ï¼š {{ $json['é£æ ¼'] }}\nåˆ†é•œæ•°é‡ï¼š {{ $json['åœºæ™¯æ•°é‡'] }}\nè§¦å‘è¯ï¼š æ—  ï¼ˆè‹¥è§¦å‘è¯å­˜åœ¨ï¼Œæ¯ä¸ªåœºæ™¯æç¤ºè¯å¥é¦–æ”¾ç½®ï¼›è‹¥ä¸ºç©ºåˆ™æ— éœ€æ”¾ç½®ï¼‰\nåˆ†é•œæ—¶é•¿ï¼š {{ $json['åˆ†é•œæ—¶é•¿'] }}\né¢å¤–è¦æ±‚ï¼š æ—  ï¼ˆè‹¥é¢å¤–è¦æ±‚å­˜åœ¨ï¼Œåˆ™éœ€è¦éµå¾ªé¢å¤–è¦æ±‚çš„è§„åˆ™ï¼›è‹¥ä¸ºç©ºåˆ™æ— éœ€éµå®ˆï¼‰\næ ¸å¿ƒç›®æ ‡\næ¯ä¸€ç»„ç”Ÿæˆçš„åˆ†é•œå†…å®¹ï¼ˆå›¾ç‰‡æç¤ºè¯ + æ—ç™½ï¼‰éœ€ç²¾å‡†ä½“ç°æ–°ä¸»é¢˜ï¼Œå¹¶å·§å¦™èå…¥å‚è€ƒè§†é¢‘ä¸­åˆ†æå¾—å‡ºçš„â€œç—…æ¯’ä¼ æ’­åŸºå› â€åŠå…¶å™äº‹ç²¾é«“ï¼ŒåŒæ—¶åˆ›æ–°æ€§åœ°å€Ÿé‰´å‚è€ƒå›¾ç‰‡æç¤ºè¯ä¸­çš„ä¼˜ç§€å…ƒç´ ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œæ‰€æœ‰åˆ†é•œå†…å®¹å¿…é¡»ç´§å¯†ç›¸è¿ï¼Œå½¢æˆä¸€ä¸ªé€»è¾‘æ¸…æ™°ã€æƒ…æ„Ÿé€’è¿›ã€é«˜æ½®è¿­èµ·ã€é¦–å°¾å‘¼åº”çš„å®Œæ•´æ•…äº‹çº¿ã€‚æœ€ç»ˆç›®æ ‡æ˜¯ç¡®ä¿å›¾ç‰‡ä¸æ—ç™½å¤©è¡£æ— ç¼åœ°èåˆï¼Œå…±åŒæ„å»ºä¸€ä¸ªå¼•äººå…¥èƒœã€èƒ½è®©è§‚ä¼—â€œçœ‹å®Œæœ‰æ‰€å¾—â€ï¼ˆæ— è®ºæ˜¯çŸ¥è¯†ã€æƒ…æ„Ÿå…±é¸£ã€å®ç”¨æŠ€å·§è¿˜æ˜¯å¨±ä¹ä»·å€¼ï¼‰çš„å®Œæ•´æ•…äº‹ï¼Œä»¥è¾¾åˆ°ç”šè‡³è¶…è¶ŠåŸä½œçš„ä¼ æ’­æ•ˆæœã€‚åœ¨æ•´ä¸ªåˆ›ä½œè¿‡ç¨‹ä¸­ï¼Œä½ éœ€ä¸»åŠ¨è¿›è¡Œâ€œè‡ªæˆ‘æ‰¹åˆ¤å¼â€è¯„ä¼°ï¼Œç¡®ä¿æ¯ä¸ªåˆ†é•œæ—¢æœåŠ¡äºæ•´ä½“æ•…äº‹ï¼Œåˆå…·å¤‡ç‹¬ç«‹çš„å¸å¼•åŠ›ã€‚\n\nè¾“å‡ºè¦æ±‚\nè¯·ä¸¥æ ¼æŒ‰ä»¥ä¸‹æ ¼å¼å°†ç»“æœå°è£…åœ¨å¯è¢«ç¨‹åºè§£æçš„JSONä¸­ã€‚\n\nã€æœ€é«˜ä¼˜å…ˆçº§ã€‘ æ‰«ææœ€ç»ˆJSONæ–‡æœ¬ä¸­çš„æ‰€æœ‰å­—ç¬¦ä¸²å€¼ï¼Œç¡®ä¿å¹¶ä¿®æ­£å…¶ä¸­æ‰€æœ‰å†…éƒ¨åŒå¼•å·éƒ½å·²æ­£ç¡®è½¬ä¹‰ä¸º \\\"ã€‚\n\nJSON å¯¹è±¡åŒ…å«ä¸€ä¸ªåä¸º storyboards çš„æ•°ç»„ï¼Œä»¥åŠåä¸º video_title_chineseã€video_title_englishã€complete_video_chinies_storyboardã€complete_video_english_storyboard çš„å­—æ®µã€‚å¤–å±‚æ— éœ€ä½¿ç”¨ ```json ä»£ç å—åŒ…è£¹ã€‚\n\nvideo_title_chinese (å­—ç¬¦ä¸²): æ ¹æ®ç”Ÿæˆçš„å®Œæ•´è§†é¢‘å†…å®¹ï¼ˆåŒ…æ‹¬æ‰€æœ‰åˆ†é•œçš„æ—ç™½å’Œå›¾ç‰‡æç¤ºè¯ï¼‰æ‹Ÿå®šä¸€ä¸ªç®€æ´çš„ä¸­æ–‡æ ‡é¢˜ã€‚æ ‡é¢˜åº”ä¸ºçº¯æ–‡æœ¬ï¼Œä¸å«ä»»ä½•æ ‡ç‚¹ç¬¦å·æˆ–ç‰¹æ®Šå­—ç¬¦ï¼Œä¸”ä¸å«å¤šä½™ç©ºæ ¼ï¼ˆä¾‹å¦‚ï¼šåƒç´ éƒ½å¸‚çˆ±æƒ…æ•…äº‹ï¼‰ã€‚\nvideo_title_english (å­—ç¬¦ä¸²): æ ¹æ®ç”Ÿæˆçš„å®Œæ•´è§†é¢‘å†…å®¹æ‹Ÿå®šä¸€ä¸ªç®€æ´çš„è‹±æ–‡æ ‡é¢˜ã€‚æ ‡é¢˜åº”ä¸ºçº¯æ–‡æœ¬ï¼Œä¸å«ä»»ä½•æ ‡ç‚¹ç¬¦å·æˆ–ç‰¹æ®Šå­—ç¬¦ï¼Œä¸”ä¸å«å¤šä½™ç©ºæ ¼ã€‚\næ¯ä¸ª storyboards åˆ†é•œå¿…é¡»åŒ…å«6ä¸ªå­—æ®µï¼Œç¼ºä¸€ä¸å¯ï¼šåˆ†é•œID (scene_id)ã€è‹±æ–‡æ—ç™½æ–‡æ¡ˆ (narration_english_content)ã€ä¸­æ–‡æ—ç™½æ–‡æ¡ˆ (narration_chinese_content)ã€ä¸­æ–‡å›¾ç‰‡æç¤ºè¯ (chinese_prompt)ã€è‹±æ–‡å›¾ç‰‡æç¤ºè¯ (english_prompt)ã€åˆ†é•œæ—¶é•¿(duration_seconds)ã€‚\n\nå›¾ç‰‡æç¤ºè¯ï¼ˆchinese_prompt, english_promptï¼‰ç”Ÿæˆè§„åˆ™ (Qwen-Image é»„é‡‘æ³•åˆ™)\nä½ ç”Ÿæˆçš„æ¯ä¸€ä¸ªæç¤ºè¯éƒ½å¿…é¡»ä¸¥æ ¼éµå¾ªä»¥ä¸‹å…­æ®µå¼åˆ†å±‚ç»“æ„ï¼Œè¿™æ˜¯é“å¾‹ï¼Œé¡ºåºç»ä¸èƒ½æ‰“ä¹±ã€‚æç¤ºè¯åº”ç®€æ´ç›´æ¥ï¼Œæ— éœ€åŒ…å«ä»»ä½•åˆ›ä½œæŒ‡å¯¼æˆ–è¯´æ˜æ€§æ–‡å­—ã€‚ä¸è¦å¸¦åºå·ï¼Œç›´æ¥æè¿°ã€‚\n\nç»“æ„ï¼š [1. è§†è§‰é£æ ¼], [2. ä¸»è¦ä¸»é¢˜], [3. ç¯å¢ƒä¸èƒŒæ™¯], [4. å…‰çº¿], [5. é¢å¤–æ•ˆæœä¸ç»†èŠ‚]\n\nç¬¬ä¸€éƒ¨åˆ†ï¼šè§†è§‰é£æ ¼ (Visual Style)\nå®šä¹‰æ•´ä½“è‰ºæœ¯é£æ ¼ã€‚ä½ å¿…é¡»ä¸¥æ ¼ä¼˜å…ˆä½¿ç”¨ç”¨æˆ·æä¾›çš„ã€æ¨¡å‹é£æ ¼ã€‘ï¼ˆå³ï¼š{{ $json['é£æ ¼'] }}ï¼‰ä½œä¸ºä¸»è¦çš„ç”»é¢é£æ ¼ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œå¯Œæœ‰åˆ›æ„çš„å»¶ä¼¸å’Œä¼˜åŒ–ï¼Œä½¿å…¶æ›´è´´åˆå…·ä½“åˆ†é•œçš„è§†è§‰éœ€æ±‚ã€‚ä¾‹å¦‚ï¼šèµ›åšæœ‹å…‹åŠ¨æ¼«é£æ ¼ (cyberpunk anime style), å°è±¡æ´¾æ²¹ç”» (impressionist oil painting), ç…§ç‰‡çº§å†™å® (photorealistic)ã€‚ï¼ˆè¯·ç¡®ä¿æ­¤å¤„çš„è‹±æ–‡æç¤ºè¯ä¹ŸåŒ…å« {{ $json['é£æ ¼'] }} çš„å¯¹åº”ç¿»è¯‘ï¼Œä¸”é£æ ¼æè¿°åº”å°½å¯èƒ½å…·ä½“åŒ–å’Œè§†è§‰åŒ–ã€‚ï¼‰\n\nç¬¬äºŒéƒ¨åˆ†ï¼šä¸»è¦ä¸»é¢˜ (Main Subject)\næè¿°ç”»é¢çš„æ ¸å¿ƒå†…å®¹ï¼Œå¦‚äººç‰©ã€åŠ¨ç‰©æˆ–ç‰©ä½“ã€‚è¯·ä¸»åŠ¨æ€è€ƒå¹¶è¡¥å……ä¸è¯¥åˆ†é•œå™äº‹ç›®çš„ç´§å¯†ç›¸å…³çš„ç»†èŠ‚ï¼Œä¾‹å¦‚ï¼šä¸€ä¸ª25å²çš„ä¸œäºšå¥³æ€§ï¼Œé¢å¸¦å¾®ç¬‘ï¼Œæ­£åœ¨ä¸“æ³¨åœ°é˜…è¯»ä¸€æœ¬å¤è€çš„ä¹¦ç± (A 25-year-old East Asian woman, with a gentle smile, intently reading an ancient book)ã€‚\n\nç¬¬ä¸‰éƒ¨åˆ†ï¼šç¯å¢ƒä¸èƒŒæ™¯ (Environment & Background)\né‡‡ç”¨ä»ååˆ°å‰çš„é€»è¾‘é¡ºåºæè¿°èƒŒæ™¯ï¼Œä»¥å»ºç«‹ç©ºé—´æ„Ÿã€‚ä¾‹å¦‚ï¼šèƒŒæ™¯æ˜¯é«˜è€¸çš„éœ“è™¹ç¯æ‘©å¤©å¤§æ¥¼å’Œé£è¡Œæ±½è½¦ï¼Œè¡—é“æ‹¥æŒ¤ (on a crowded street in a futuristic metropolis filled with towering neon-lit skyscrapers and flying vehicles)ã€‚\n\nç¬¬å››éƒ¨åˆ†ï¼šå…‰çº¿ (Lighting)\næè¿°å…‰ç…§æ•ˆæœã€‚ä¾‹å¦‚ï¼šç”µå½±æ„Ÿå…‰çº¿ï¼Œå…·æœ‰æˆå‰§æ€§çš„é˜´å½±å’Œåœ°é¢ä¸Šçš„éœ“è™¹ç¯åå°„ (cinematic lighting with dramatic shadows and neon reflections on the wet ground)ã€‚\n\nç¬¬äº”éƒ¨åˆ†ï¼šé¢å¤–æ•ˆæœä¸ç»†èŠ‚ (Extra Effects & Details)\næ·»åŠ å¢å¼ºçœŸå®æ„Ÿå’Œç»†èŠ‚çš„è¯æ¡ã€‚ä¾‹å¦‚ï¼šæè‡´ç»†èŠ‚, 8K, HDR, é”åˆ©å¯¹ç„¦, é²œè‰³çš„è‰²å½© (ultra detailed, 8k, HDR, sharp focus, vibrant colors)ã€‚\n\nå®Œæ•´åˆ†é•œæç¤ºè¯ (complete_video_chinies_storyboard, complete_video_english_storyboard) è¦æ±‚\næ­¤å­—æ®µå†…å®¹ä¸ºæ‰€æœ‰åˆ†é•œçš„ chinese_prompt æˆ– english_prompt çš„ç®€å•åˆå¹¶ï¼Œç”¨äºå¿«é€Ÿé¢„è§ˆã€‚\n\næ—ç™½æ–‡æ¡ˆ (narration_english_content, narration_chinese_content) è¦æ±‚\n\nç²¾å‡†æ—¶é•¿åŒ¹é…ï¼š æ¯ä¸€ä¸ªåˆ†é•œçš„æ—¶é•¿æ˜¯ {{ $json['åˆ†é•œæ—¶é•¿'] }}sï¼Œä½ éœ€è¦ç²¾å‡†åŒ¹é…è¿™ä¸ªæ—¶é•¿çš„æ—ç™½æ–‡æ¡ˆï¼Œç¡®ä¿èƒ½åœ¨ {{ $json['åˆ†é•œæ—¶é•¿'] }}s å†…é€šè¿‡è‡ªç„¶è¯­é€Ÿå™è¿°å®Œæ¯•ã€‚\nå†…å®¹ç²¾å‡†ä¸é£æ ¼åŒ–ï¼š æ—ç™½æåˆ°çš„å…³é”®ä¿¡æ¯å¿…é¡»ä¸å½“å‰åˆ†é•œç”»é¢ç²¾å‡†å¯¹åº”ã€‚ä½ éœ€è¦ç²¾å‡†åˆ†æå¹¶å¤åˆ»å‚è€ƒè§†é¢‘çš„è¯­è¨€åŠæ–‡æ¡ˆé£æ ¼ï¼Œä¸ºæ¯ä¸ªåˆ†é•œåˆ›ä½œé«˜åº¦é£æ ¼åŒ–çš„æ—ç™½ã€‚\nå™äº‹å®Œæ•´æ€§ä¸å…³è”æ€§ï¼š è¿ç»­åˆ†é•œçš„æ—ç™½è®¾è®¡å¿…é¡»è®©è§‚ä¼—æœ‰â€œçœ‹å®Œæœ‰æ‰€å¾—â€çš„æ»¡è¶³æ„Ÿã€‚æ—ç™½å†…å®¹ä¹‹é—´éœ€å…·æœ‰ä¸¥å¯†çš„é€»è¾‘å…³è”å’Œæƒ…æ„Ÿé€’è¿›ï¼Œç²¾å¿ƒæ„å»ºæƒ…ç»ªæ›²çº¿ï¼ˆèµ·æ‰¿è½¬åˆï¼‰ï¼Œç¡®ä¿æ¯ä¸ªåˆ†é•œçš„æ—ç™½éƒ½æ¨åŠ¨æ•…äº‹å‘å‰å‘å±•ï¼Œå¹¶ä¸ç”»é¢å†…å®¹ç›¸è¾…ç›¸æˆï¼Œå…±åŒæ„å»ºä¸€ä¸ªæµç•…ã€å¼•äººå…¥èƒœçš„å™äº‹å¼§çº¿ã€‚æœ€ç»ˆæ—ç™½è„šæœ¬å¿…é¡»æ˜¯ä¸€ä¸ªé€»è¾‘é—­ç¯ã€é¦–å°¾å‘¼åº”çš„å®Œæ•´æ•…äº‹ï¼Œåœ¨æŒ‡å®šåˆ†é•œæ•°é‡å†…é«˜æ•ˆã€å®Œæ•´åœ°ä¼ è¾¾æ ¸å¿ƒä¿¡æ¯å’Œæƒ…æ„Ÿï¼Œç¡®ä¿è§‚ä¼—ä»å¤´åˆ°å°¾éƒ½èƒ½å……åˆ†äº†è§£äº‹ä»¶è„‰ç»œä¸å…³é”®ä¿¡æ¯ï¼Œè·å¾—æ·±å±‚æ¬¡çš„æ»¡è¶³æ„Ÿæˆ–æ€è€ƒã€‚",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.1,
      "position": [
        -784,
        416
      ],
      "id": "9a7aa399-9f99-45e0-9408-401386ca2914",
      "name": "AI Agent",
      "retryOnFail": true
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        -720,
        640
      ],
      "id": "1b1cac51-3df0-481b-a98c-e7a4e210d4bb",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "BlSGFxurUowtTfcc",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "fieldToSplitOut": "storyboards",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -208,
        416
      ],
      "id": "77bb2e75-3e5d-4e59-a6f9-208023da382a",
      "name": "Split Out1"
    },
    {
      "parameters": {
        "jsCode": "// N8N Code èŠ‚ç‚¹è„šæœ¬\n\n// 1. è·å–ç¬¬ä¸€ä¸ªè¾“å…¥é¡¹ã€‚\n// å‡è®¾æ‚¨è¦è§£æçš„ JSON å­—ç¬¦ä¸²ä½äºç¬¬ä¸€ä¸ªè¾“å…¥é¡¹çš„ 'json.output' å±æ€§ä¸­ã€‚\nconst inputItem = $input.first();\n\n// 2. éªŒè¯è¾“å…¥æ•°æ®æ˜¯å¦å­˜åœ¨ä¸”ç¬¦åˆé¢„æœŸç»“æ„\nif (!inputItem || !inputItem.json || typeof inputItem.json.output !== 'string') {\n  // å¦‚æœè¾“å…¥æ•°æ®ä¸ç¬¦åˆé¢„æœŸï¼Œè¿”å›ä¸€ä¸ªé”™è¯¯ä¿¡æ¯\n  console.error(\"è¾“å…¥æ•°æ®ä¸ç¬¦åˆé¢„æœŸæ ¼å¼ (ç¼ºå°‘ items[0].json.output æˆ–å…¶ä¸æ˜¯å­—ç¬¦ä¸²)\");\n  return [{ json: { error: \"è¾“å…¥æ•°æ®ç¼ºå¤±æˆ–æ ¼å¼ä¸æ­£ç¡®ï¼Œæ— æ³•è§£æ JSONã€‚\" } }];\n}\n\nconst rawJsonStringWithMarkdown = inputItem.json.output;\n\n// 3. ç§»é™¤ Markdown ä»£ç å—çš„å›´æ  (```json å’Œ ```)\n// ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…å¹¶ç§»é™¤å­—ç¬¦ä¸²å¼€å¤´å’Œç»“å°¾çš„ ```json\\n å’Œ \\n```\nconst cleanedJsonString = rawJsonStringWithMarkdown\n  .replace(/^```json\\s*\\n/, '') // åŒ¹é…å­—ç¬¦ä¸²å¼€å¤´çš„ \"```json\" åè·Ÿå¯é€‰ç©ºç™½å’Œæ¢è¡Œç¬¦\n  .replace(/\\n\\s*```$/, '');    // åŒ¹é…å­—ç¬¦ä¸²ç»“å°¾çš„æ¢è¡Œç¬¦åè·Ÿå¯é€‰ç©ºç™½å’Œ \"```\"\n\nlet parsedData;\ntry {\n  // 4. è§£ææ¸…ç†åçš„ JSON å­—ç¬¦ä¸²ä¸º JavaScript å¯¹è±¡\n  parsedData = JSON.parse(cleanedJsonString);\n} catch (error) {\n  // 5. é”™è¯¯å¤„ç†ï¼šå¦‚æœ JSON å­—ç¬¦ä¸²æ ¼å¼ä¸æ­£ç¡®ï¼ŒJSON.parse() ä¼šæŠ›å‡ºé”™è¯¯\n  console.error(\"è§£æ JSON å­—ç¬¦ä¸²æ—¶å‡ºé”™:\", error);\n  // è¿”å›ä¸€ä¸ªåŒ…å«é”™è¯¯ä¿¡æ¯çš„è¾“å‡ºï¼Œä»¥ä¾¿åœ¨N8Nä¸­æ•è·å’Œå¤„ç†\n  return [{ json: { error: \"è§£æ JSON å¤±è´¥\", details: error.message } }];\n}\n\n// 6. è¿”å›è§£æåçš„æ•°æ®\n// N8N çš„ Code èŠ‚ç‚¹æœŸæœ›è¿”å›ä¸€ä¸ªåŒ…å« 'json' å±æ€§çš„å¯¹è±¡æ•°ç»„ã€‚\n// è§£æåçš„æ•°æ®å°†ä½œä¸ºä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„è¾“å…¥ã€‚\nreturn [{ json: parsedData }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -432,
        416
      ],
      "id": "74ec266e-fdfb-4135-b7ea-bf26fe0d22d4",
      "name": "Code"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        16,
        416
      ],
      "id": "b9764660-25b1-4e65-a3e0-3bc8cea5a241",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "7c856999-278c-4849-adf5-d9cf2c15570b",
              "leftValue": "={{ $json.data }}",
              "rightValue": "=SUCCESS",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        576,
        336
      ],
      "id": "60cf5c5b-6c61-4856-bb9c-7c3d72fc2fbe",
      "name": "If2"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        800,
        336
      ],
      "id": "8fd121f7-18ba-4c05-974c-d8ca38fa622a",
      "name": "Wait1",
      "webhookId": "6446f4af-9b98-42b9-998d-4b74c5a91b12"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=ç”»é¢å›¾ç‰‡å·²å‘é€\n{{ $json.data[0].fileUrl }}\nç”Ÿæˆçš„å›¾ç‰‡çš„æç¤ºè¯å¦‚ä¸‹ï¼Œå¯ä¾›å‚è€ƒï¼š\n{{ $('Loop Over Items').item.json.narration_chinese_content }}\nå½“å‰åˆ†é•œæ—ç™½ï¼š\n- `å½“å‰åˆ†é•œ ID`: {{ $('Split Out1').item.json.scene_id }} ,ä½ éœ€è¦æ ¹æ®è¿™ä¸ª ID æ‰¾åˆ°ä¸‹ä¸€ä¸ªåˆ†é•œæ—ç™½ï¼Œæ»¡è¶³æŒ‡ä»¤è¾“å…¥éœ€æ±‚ã€‚\n- `å½“å‰åˆ†é•œæ—¶é•¿`: {{ $('Split Out1').item.json.duration_seconds }} ç§’\n\n- `å½“å‰åˆ†é•œæ—ç™½ä¸­æ–‡`:{{ $('Split Out1').item.json.narration_chinese_content }}\n\n- `å½“å‰åˆ†é•œæ—ç™½è‹±æ–‡`:{{ $('Split Out1').item.json.narration_english_content }}\n\n\n- `å®Œæ•´åˆ†é•œä¸­æ–‡è„šæœ¬`: {{ $('Code').item.json.complete_video_chinies_storyboard }}\n\n- `å®Œæ•´åˆ†é•œè‹±æ–‡è„šæœ¬`:{{ $('Code').item.json.complete_video_english_storyboard }}\n\né¢å¤–è¦æ±‚ï¼š\næ•´ä½“é£æ ¼ï¼š{{ $('ä¸»è¦è®¾ç½®å‚æ•°').item.json['æ¨¡å‹é£æ ¼'] }}\n",
        "options": {
          "systemMessage": "=AI è§†é¢‘ç”Ÿæˆæç¤ºè¯æŒ‡å—ï¼ˆåŸºäºå›¾ç‰‡è¾“å…¥ï¼‰\nğŸ¬ è§’è‰²å®šä¹‰\nä½ æ˜¯ä¸€åé¡¶çº§è§†è§‰å™äº‹å¯¼æ¼”ä¸AIè§†é¢‘æç¤ºè¯ä¸“å®¶ã€‚ä½ çš„ä»»åŠ¡æ˜¯æ·±å…¥è§£è¯»ç”¨æˆ·æä¾›çš„é™æ€å›¾ç‰‡ï¼Œç»“åˆå½“å‰ä¸ä¸‹ä¸€ä¸ªåˆ†é•œçš„æ—ç™½ï¼Œä»¥ç²¾å‡†æ„æ€å¹¶åˆ›ä½œé«˜åº¦ä¼˜åŒ–çš„è‹±æ–‡è§†é¢‘æç¤ºè¯ã€‚è¿™äº›æç¤ºè¯ä¸“ä¸ºæœ€æ–°çš„AIå›¾ç‰‡ç”Ÿæˆè§†é¢‘æ¨¡å‹è®¾è®¡ï¼ˆå¦‚ OpenAI Soraã€Runwayã€Pika Labsã€Luma AIã€Klingã€Google Veo ç­‰ï¼‰ï¼Œç”¨äºæŒ‡å¯¼ç”Ÿæˆ5-10ç§’åŠ¨æ€æµç•…çš„è§†é¢‘ã€‚\n\nğŸ¯ æ ¸å¿ƒç›®æ ‡\nè¾“å‡ºç²¾ç‚¼ä¸”é«˜è´¨é‡çš„è‹±æ–‡è§†é¢‘æç¤ºè¯ï¼Œä»¥ç²¾å‡†æ§åˆ¶åŠ¨æ€æ•ˆæœï¼Œç¡®ä¿è§†é¢‘æµç•…è‡ªç„¶ï¼Œæ— ç¼è¡”æ¥å½“å‰åˆ†é•œæ—ç™½ä¸ä¸‹ä¸€ä¸ªåˆ†é•œæ—ç™½æ‰€æç»˜çš„æ•…äº‹è¿›å±•ã€‚ç”Ÿæˆçš„è§†é¢‘åº”ä¸è¾“å…¥å›¾ç‰‡çš„è§†è§‰é£æ ¼å®Œç¾èåˆï¼Œé¿å…ä»»ä½•ä¸è‡ªç„¶çš„æ‰­æ›²æˆ–çªå…€æ„Ÿã€‚\n\nğŸ“¥ è¾“å…¥ä¿¡æ¯\nå½“å‰åˆ†é•œå›¾ç‰‡ï¼ˆCurrent Imageï¼‰: ç”¨æˆ·æä¾›çš„é™æ€å›¾ç‰‡ï¼Œä½œä¸ºè§†é¢‘ç”Ÿæˆçš„è§†è§‰èµ·ç‚¹ã€‚\nå½“å‰åˆ†é•œæ—ç™½ï¼ˆCurrent Image Narrationï¼‰: å¯¹å½“å‰å›¾ç‰‡åœºæ™¯æˆ–å¯¹è¯çš„æè¿°ã€‚è¿™å®šä¹‰äº†è§†é¢‘çš„èµ·å§‹çŠ¶æ€å’ŒèƒŒæ™¯æ•…äº‹ã€‚\nä¸‹ä¸€ä¸ªåˆ†é•œæ—ç™½ï¼ˆNext Image Narrationï¼‰: å¯¹ä¸‹ä¸€ä¸ªåˆ†é•œå°†è¦å‘ç”Ÿäº‹ä»¶æˆ–å¯¹è¯çš„æè¿°ã€‚è¿™å¯¹äºæ„å»ºè§†é¢‘çš„å™äº‹æ–¹å‘å’Œé¢„ç¤ºæœªæ¥äº‹ä»¶è‡³å…³é‡è¦ã€‚\nç”Ÿæˆå½“å‰å›¾ç‰‡çš„æç¤ºè¯ï¼ˆImage Generation Promptï¼‰: ç”¨äºç”Ÿæˆå½“å‰å›¾ç‰‡çš„åŸå§‹æç¤ºè¯ï¼Œæœ‰åŠ©äºç†è§£å›¾ç‰‡çš„åˆ›ä½œæ„å›¾ã€è§†è§‰é£æ ¼å’Œç‰¹å®šå…ƒç´ ã€‚\né¢å¤–è¦æ±‚ï¼ˆAdditional Requirementsï¼‰: è‹¥å­˜åœ¨ï¼Œåˆ™éœ€ä¸¥æ ¼éµå¾ªï¼›è‹¥ä¸ºç©ºï¼Œåˆ™æ— éœ€éµå®ˆã€‚\nğŸ› ï¸ æç¤ºè¯æ„å»ºåŸåˆ™\næ„å»ºæç¤ºè¯æ—¶ï¼Œä½ éœ€è¦æ‰®æ¼”ä¸€åæ•…äº‹è®²è¿°è€…ï¼Œé€šè¿‡åŠ¨æ€ç”»é¢å°†å½“å‰åˆ†é•œæ—ç™½çš„å†…å®¹è‡ªç„¶åœ°è¿‡æ¸¡åˆ°ä¸‹ä¸€ä¸ªåˆ†é•œæ—ç™½ã€‚é€æ­¥å¼•å…¥ä»¥ä¸‹å…ƒç´ ã€‚æ¯æ¬¡ä¿®æ”¹å»ºè®®ä»…è°ƒæ•´ä¸€ç§å…ƒç´ ï¼Œä»¥å‡†ç¡®è¯„ä¼°å…¶å½±å“ã€‚\n\næ¨èé¡ºåºï¼šå™äº‹è¿‡æ¸¡ (Narrative Transition) â†’ ä¸»ä½“è¿åŠ¨ â†’ åœºæ™¯è¿åŠ¨ â†’ é•œå¤´è¿åŠ¨ â†’ é£æ ¼æè¿°ã€‚\n\na. å™äº‹è¿‡æ¸¡ (Narrative Transition)\næ ¸å¿ƒä»»åŠ¡: åŸºäºå½“å‰å›¾ç‰‡ï¼Œæ„æ€ä¸€ä¸ª5-10ç§’çš„è§†é¢‘ç‰‡æ®µï¼Œè¯¥ç‰‡æ®µéœ€ä½œä¸ºå½“å‰æ—ç™½ä¸ä¸‹ä¸€ä¸ªæ—ç™½ä¹‹é—´çš„è§†è§‰æ¡¥æ¢ï¼Œå±•ç°æ•…äº‹çš„è¿›å±•æˆ–æƒ…ç»ªçš„è½¬å˜ã€‚\nç­–ç•¥:\nå®Œæˆå½“å‰æ—ç™½æš—ç¤ºçš„åŠ¨ä½œæˆ–æƒ…ç»ª: å¦‚æœå½“å‰æ—ç™½æè¿°äº†ä¸€ä¸ªæœªå®Œæˆçš„åŠ¨ä½œæˆ–æƒ…ç»ªé«˜æ½®ï¼Œè§†é¢‘åº”å±•ç°å…¶ç»“å±€æˆ–å»¶ä¼¸ã€‚\nå¼•å…¥ä¸‹ä¸€ä¸ªæ—ç™½æš—ç¤ºçš„å…ƒç´ æˆ–æƒ…å¢ƒ: è§†é¢‘åº”å¼€å§‹å±•ç°ä¸ä¸‹ä¸€ä¸ªæ—ç™½ç›¸å…³çš„æ–°åŠ¨ä½œã€æ–°è§’è‰²ã€æ–°åœºæ™¯å˜åŒ–æˆ–æƒ…ç»ªé“ºå«ã€‚\nå±•ç¤ºå› æœå…³ç³»æˆ–æƒ…ç»ªè½¬å˜: å¦‚æœä¸¤ä¸ªæ—ç™½ä¹‹é—´å­˜åœ¨å› æœè”ç³»æˆ–è§’è‰²æƒ…ç»ªçš„æ˜¾è‘—å˜åŒ–ï¼Œè§†é¢‘åº”æ¸…æ™°åœ°è¡¨ç°è¿™ä¸€è¿‡ç¨‹ã€‚\nç¤ºä¾‹:\nå½“å‰æ—ç™½ï¼šâ€œå¥¹ç„¦æ€¥åœ°çœ‹ç€è¿œæ–¹ã€‚â€ ä¸‹ä¸€ä¸ªæ—ç™½ï¼šâ€œä¸€è¾†è½¦ç–¾é©°è€Œæ¥ã€‚â€\nè§†é¢‘æ„æ€ï¼šå±•ç°å¥¹ç„¦æ€¥çš„çœ¼ç¥ï¼Œç„¶åé•œå¤´æ¸æ¸ç§»åŠ¨æˆ–å‰æ™¯å‡ºç°è¿¹è±¡ï¼Œé¢„ç¤ºè½¦è¾†çš„åˆ°æ¥ã€‚\næç¤ºè¯ç‰‡æ®µï¼š...then her eyes widen slightly, subtly reacting as a faint glow appears on the horizon, hinting at an approaching vehicle.\nå½“å‰æ—ç™½ï¼šâ€œä»–æ·±å¸ä¸€å£æ°”ã€‚â€ ä¸‹ä¸€ä¸ªæ—ç™½ï¼šâ€œä»–ç»ˆäºé¼“èµ·å‹‡æ°”å¼€å£ã€‚â€\nè§†é¢‘æ„æ€ï¼šå±•ç°ä»–æ·±å¸æ°”çš„è¿‡ç¨‹ï¼Œç„¶åæ˜¯å¼€å£å‰çš„ä¸€ä¸çŠ¹è±«å’Œæœ€ç»ˆçš„åŠ¨ä½œã€‚\næç¤ºè¯ç‰‡æ®µï¼š...he slowly exhales, his lips parting slightly, a moment of hesitation before he begins to speak.\nb. ä¸»ä½“è¿åŠ¨ (Subject Motion)\næ¸…æ™°æè¿°å›¾ç‰‡ä¸­ä¸»ä½“ä¸ºå®ç°å™äº‹è¿‡æ¸¡è€Œå‘ç”Ÿçš„åŠ¨ä½œã€å§¿æ€æˆ–è¡¨æƒ…å˜åŒ–ã€‚\næ˜ç¡®æŒ‡ç§°ä¸»ä½“ï¼šå¦‚ â€œthe subjectâ€, â€œthe figure in the foregroundâ€, â€œitâ€, â€œhe/sheâ€ã€‚\nç¤ºä¾‹ï¼š\nThe subject slowly turns around, a look of surprise washing over their face. (è¡”æ¥ä¸‹ä¸€ä¸ªæ—ç™½å¯èƒ½æš—ç¤ºçš„çªå‘äº‹ä»¶)\nThe figure in the foreground raises a hand to wave goodbye, then turns and walks away. (å®Œæˆå½“å‰æ—ç™½æš—ç¤ºçš„å‘Šåˆ«åŠ¨ä½œï¼Œå¹¶å¼•å…¥ç¦»å¼€çš„åœºæ™¯)\nc. å¤šä¸»ä½“è¿åŠ¨ (Multiple Subjects)\nä½¿ç”¨ç©ºé—´ä½ç½®æˆ–æ˜¾è‘—ç‰¹å¾è¿›è¡ŒåŒºåˆ†ï¼Œæè¿°å¤šä¸»ä½“å¦‚ä½•å…±åŒæˆ–ç‹¬ç«‹åœ°æ¨åŠ¨å™äº‹è¿›å±•ã€‚\nç¤ºä¾‹ï¼š\nThe subject on the left walks forward to meet the subject on the right, who extends a hand for a handshake. (ä¸ºä¸‹ä¸€ä¸ªæ—ç™½å¯èƒ½æš—ç¤ºçš„äº’åŠ¨æˆ–åè®®åšé“ºå«)\nThe woman in the red dress shakes her head in disagreement, while the man beside her subtly clenches his fist. (å±•ç°å¤šè§’è‰²å¯¹å½“å‰æƒ…å¢ƒçš„ä¸åŒååº”ï¼Œæ¨åŠ¨å‰§æƒ…å‘å±•)\nd. åœºæ™¯è¿åŠ¨ (Scene Motion)\næè¿°ç¯å¢ƒå¯¹ä¸»ä½“åŠ¨ä½œçš„ååº”ï¼Œæˆ–ä¸ºé…åˆå™äº‹è¿‡æ¸¡è€Œå‘ç”Ÿçš„è‡ªä¸»å˜åŒ–ã€‚\nç­–ç•¥ï¼š\néšæ€§é©±åŠ¨ï¼ˆæ¨èï¼‰ï¼šæš—ç¤ºç¯å¢ƒå˜åŒ–ã€‚\nThe subject runs through a dusty desert, dust kicking up intensely behind them with each stride. (å¼ºè°ƒè·‘åŠ¨é€ æˆçš„ç¯å¢ƒå½±å“ï¼Œä¸ºä¸‹ä¸€ä¸ªæ—ç™½å¯èƒ½æš—ç¤ºçš„å‰§çƒˆåŠ¨ä½œåšé“ºå«)\næ˜¾æ€§æŒ‡ä»¤ï¼šæ˜ç¡®æè¿°ç¯å¢ƒå˜åŒ–ã€‚\nThe subject runs through the desert as the sun begins to set, casting long, dramatic shadows that stretch across the sand. (é€šè¿‡ç¯å¢ƒå˜åŒ–æ¨åŠ¨æ—¶é—´æµé€ï¼Œä¸ºä¸‹ä¸€ä¸ªæ—ç™½æš—ç¤ºçš„å¤œæ™šåœºæ™¯åšé“ºå«)\ne. é•œå¤´è¿åŠ¨ (Camera Motion)\næ˜ç¡®è™šæ‹Ÿæ‘„åƒæœºçš„è¿åŠ¨æ–¹å¼ä¸è½¨è¿¹ï¼Œä»¥å¢å¼ºå™äº‹æ„Ÿå’Œæƒ…ç»ªè¡¨è¾¾ã€‚\nå¯å¾ªåºæ¸è¿›åœ°å¼•å…¥ï¼Œä¾‹å¦‚ï¼šstatic shot, handheld camera, dolly zoom, pan, tracking shot, follow subject, focus pullã€‚\nç¤ºä¾‹ï¼š\nHandheld camera follows the running dog from behind, then slowly pans up and over its head to reveal the vast, open field ahead. (å¼•å¯¼è§‚ä¼—è§†çº¿åˆ°ä¸‹ä¸€ä¸ªåœºæ™¯çš„å…³é”®å…ƒç´ æˆ–å¹¿é˜”èƒŒæ™¯)\nCamera slowly zooms in on the character's face, capturing the nuanced shift from worry to determination. (å¼ºè°ƒè§’è‰²æƒ…ç»ªçš„è½¬å˜ï¼Œä¸å™äº‹è¿‡æ¸¡ç›¸ç¬¦)\nf. é£æ ¼æè¿° (Style Descriptors)\nè®¾å®šæ•´ä½“åŠ¨æ€èŠ‚å¥å’Œè§†è§‰ç¾å­¦ï¼Œç¡®ä¿ä¸å½“å‰å›¾ç‰‡çš„é£æ ¼ä»¥åŠæ•…äº‹çš„æ•´ä½“æƒ…ç»ªç›¸ç¬¦ã€‚\nç»´åº¦åŒ…æ‹¬ï¼š\nè¿åŠ¨é€Ÿç‡ï¼šslow motion, fast-paced, time-lapse\nåŠ¨æ€è´¨æ„Ÿï¼šlive-action realism, smooth animation, stop-motion, hyperrealistic\nè‰ºæœ¯é£æ ¼ï¼šcinematic, dreamlike, retro film look, dramatic lighting, vibrant colors\nç¤ºä¾‹ï¼š\nThe subject walks in the rain, cinematic, slow motion, with a pervasive sense of melancholy. (å¼ºåŒ–æƒ…ç»ªï¼Œä¸æ•…äº‹è¿›å±•ç›¸ç¬¦)\nA vibrant sunset over the city, time-lapse, showcasing bustling urban life, hyperrealistic. (é€šè¿‡é£æ ¼æè¿°è¥é€ ç‰¹å®šæ°›å›´ï¼Œä¸ºåç»­æ•…äº‹æä¾›èƒŒæ™¯)\nâœ… æç¤ºè¯æœ€ä½³å®è·µ\nç²¾ç‚¼ç›´æ¥ï¼šä½¿ç”¨è‹±æ–‡ã€è¯­è¨€ç®€æ´æ˜äº†ï¼Œé¿å…æ­§ä¹‰ã€‚\nèšç„¦åŠ¨æ€ä¸å™äº‹ï¼šæ˜ç¡®æè¿°åŠ¨ä½œã€å˜åŒ–ä»¥åŠå®ƒä»¬å¦‚ä½•æ¨åŠ¨æ•…äº‹è¿›å±•ï¼Œé¿å…é™æ€é‡å¤ã€‚\nè‚¯å®šå¼æŒ‡ä»¤ï¼šç”¨ç§¯æã€æ˜ç¡®çš„æè¿°ï¼Œé¿å…è´Ÿé¢æŒ‡ä»¤ã€‚\næ¨èï¼šâ€œremains stillâ€ è€Œé â€œdoes not moveâ€ã€‚\nç®€åŒ–å¥æ³•ï¼šé¿å…é•¿å¥å’Œå¤æ‚çš„ä»å¥ç»“æ„ã€‚\néå¯¹è¯æŒ‡ä»¤ï¼šç›´æ¥é™ˆè¿°æ‰€éœ€åŠ¨æ€ï¼Œé¿å…å£è¯­è¯·æ±‚ã€‚\nè¿­ä»£ä¼˜åŒ–ï¼šä»ç®€å•åŠ¨ä½œå¼€å§‹ï¼Œé€æ­¥å¢åŠ å¤æ‚å…ƒç´ è¿›è¡ŒéªŒè¯ä¼˜åŒ–ã€‚\nğŸ“¤ è¾“å‡ºè¦æ±‚\nè¯·å°†ç²¾å¿ƒè®¾è®¡çš„è‹±æ–‡è§†é¢‘æç¤ºè¯ä¸¥æ ¼ç½®äº XML æ ‡ç­¾ä¸­è¾“å‡ºï¼Œæ— ä»»ä½•é¢å¤–å…ƒç´ ï¼Œæ— æ¢è¡Œç¬¦ç­‰é¢å¤–ç¬¦å·ï¼š\n\n<XML>\n<prompt_en>Your precisely crafted English video prompt here.</prompt_en>\næç¤ºè¯ä¸¥æ ¼æ§åˆ¶åœ¨200è¯ä»¥å†…ã€‚\nç¡®ä¿ç‹¬ç«‹å®Œæ•´ã€å¯ç›´æ¥ç”¨äºé¡¶çº§AIè§†é¢‘ç”Ÿæˆæ¨¡å‹ã€‚\næè¿°ç²¾å‡†ã€å‡ç»ƒä¸”å¯Œæœ‰è§†è§‰è¡¨ç°åŠ›ã€‚",
          "passthroughBinaryImages": true
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        -1760,
        1056
      ],
      "id": "ccea3abe-33ef-415c-a3d5-e2ef0d18c34f",
      "name": "è§†é¢‘æç¤ºè¯-å›¾ç‰‡åŠ¨æ€è§†é¢‘",
      "retryOnFail": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "756842f1-2847-41e8-a8a1-934efbd3de20",
              "name": "è§†é¢‘æç¤ºè¯",
              "value": "={{ $json.output.replace(/[\\s\\S]*<prompt_en>/, '').replace(/<\\/prompt_en>[\\s\\S]*/, '') }}",
              "type": "string"
            },
            {
              "id": "b0a67f14-7b0d-498e-a071-23da144fad73",
              "name": "å›¾ç‰‡æç¤ºè¯",
              "value": "={{ $('Loop Over Items').item.json.english_prompt }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1408,
        1056
      ],
      "id": "f46c3674-c5d7-4322-a359-26b86b23d855",
      "name": "è®¾ç½®å‚æ•°-è§†é¢‘æç¤ºè¯"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        -1696,
        1280
      ],
      "id": "6a9f3f45-5f33-4684-9bd6-34229bbfd5b1",
      "name": "Google Gemini Chat Model3",
      "credentials": {
        "googlePalmApi": {
          "id": "BlSGFxurUowtTfcc",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "7c856999-278c-4849-adf5-d9cf2c15570b",
              "leftValue": "={{ $json.data }}",
              "rightValue": "=SUCCESS",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -736,
        976
      ],
      "id": "bf5bf477-69fd-4898-b9a5-d8593ac49c9c",
      "name": "If3"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -512,
        1152
      ],
      "id": "f8eed3d4-324f-43b2-b0b5-5cc9ad8362c5",
      "name": "Wait2",
      "webhookId": "8c6694cf-c0e2-4590-bf56-3e9130849107"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "6d5c12d3-725f-4ff5-8a6d-8deea8e7029d",
              "name": "æ—ç™½",
              "value": "={{ JSON.parse(($json.candidates?.[0]?.content?.parts?.[0]?.text ?? '').match(/```json\\s*([\\s\\S]*?)```/)?.[1] ?? '{}') }}",
              "type": "object"
            },
            {
              "id": "5d296e5e-c502-4ce2-90f1-da4ce659c83b",
              "name": "å£°éŸ³ 1",
              "value": "=v1",
              "type": "string"
            },
            {
              "id": "7e4355f4-2f6e-4873-9430-7f4f24c47c97",
              "name": "å£°éŸ³ 2",
              "value": "=v2",
              "type": "string"
            },
            {
              "id": "5f2363d7-0e5d-4fd2-bf85-2774088ac907",
              "name": "å£°éŸ³ 3",
              "value": "=v3",
              "type": "string"
            },
            {
              "id": "4d01deec-63e5-4253-846d-a7a697137258",
              "name": "w",
              "value": "={\n  \"10\": {\n    \"inputs\": {\n      \"top_k\": 30,\n      \"top_p\": 0.8000000000000002,\n      \"temperature\": 0.8000000000000002,\n      \"num_beams\": 3,\n      \"max_mel_tokens\": 1500,\n      \"max_text_tokens_per_sentence\": 120,\n      \"custom_cuda_kernel\": false,\n      \"deepspeed\": false,\n      \"unload_model\": true,\n      \"emo_alpha\": 1.0000000000000002,\n      \"emo_vector\": \"\",\n      \"use_emo_text\": false,\n      \"emo_text\": \"\",\n      \"use_random\": false,\n      \"emo_alpha_s2\": 1.0000000000000002,\n      \"emo_vector_s2\": \"\",\n      \"use_emo_text_s2\": false,\n      \"emo_text_s2\": \"\",\n      \"use_random_s2\": false,\n      \"audio\": [\n        \"11\",\n        0\n      ],\n      \"text\": [\n        \"14\",\n        0\n      ]\n    },\n    \"class_type\": \"IndexTTS2Run\",\n    \"_meta\": {\n      \"title\": \"IndexTTS2 Run\"\n    }\n  },\n  \"11\": {\n    \"inputs\": {\n      \"audio\": \"989f8a76d18f40227e6016b6b3496934ad0a9ba5a887937261c84f548955f0c5.mp3\",\n      \"audioUI\": \"\"\n    },\n    \"class_type\": \"LoadAudio\",\n    \"_meta\": {\n      \"title\": \"åŠ è½½éŸ³é¢‘\"\n    }\n  },\n  \"14\": {\n    \"inputs\": {\n      \"multi_line_prompt\": \"æ—ç™½1\"\n    },\n    \"class_type\": \"MultiLinePromptIndex\",\n    \"_meta\": {\n      \"title\": \"å¤šè¡Œæ–‡æœ¬æ¡†\"\n    }\n  },\n  \"37\": {\n    \"inputs\": {\n      \"filename_prefix\": \"tts\",\n      \"quality\": \"320k\",\n      \"audioUI\": \"\",\n      \"audio\": [\n        \"10\",\n        0\n      ]\n    },\n    \"class_type\": \"SaveAudioMP3\",\n    \"_meta\": {\n      \"title\": \"Save Audio (MP3)\"\n    }\n  },\n  \"38\": {\n    \"inputs\": {\n      \"filename_prefix\": \"ComfyUI\",\n      \"only_preview\": false,\n      \"images\": [\n        \"215\",\n        0\n      ]\n    },\n    \"class_type\": \"easy imageSave\",\n    \"_meta\": {\n      \"title\": \"å›¾åƒä¿å­˜\"\n    }\n  },\n  \"41\": {\n    \"inputs\": {\n      \"multi_line_prompt\": \"æ—ç™½3\"\n    },\n    \"class_type\": \"MultiLinePromptIndex\",\n    \"_meta\": {\n      \"title\": \"å¤šè¡Œæ–‡æœ¬æ¡†\"\n    }\n  },\n  \"42\": {\n    \"inputs\": {\n      \"top_k\": 30,\n      \"top_p\": 0.8000000000000002,\n      \"temperature\": 0.8000000000000002,\n      \"num_beams\": 3,\n      \"max_mel_tokens\": 1500,\n      \"max_text_tokens_per_sentence\": 120,\n      \"custom_cuda_kernel\": false,\n      \"deepspeed\": false,\n      \"unload_model\": true,\n      \"emo_alpha\": 1.0000000000000002,\n      \"emo_vector\": \"\",\n      \"use_emo_text\": false,\n      \"emo_text\": \"\",\n      \"use_random\": false,\n      \"emo_alpha_s2\": 1.0000000000000002,\n      \"emo_vector_s2\": \"\",\n      \"use_emo_text_s2\": false,\n      \"emo_text_s2\": \"\",\n      \"use_random_s2\": false,\n      \"audio\": [\n        \"11\",\n        0\n      ],\n      \"text\": [\n        \"41\",\n        0\n      ]\n    },\n    \"class_type\": \"IndexTTS2Run\",\n    \"_meta\": {\n      \"title\": \"IndexTTS2 Run\"\n    }\n  },\n  \"44\": {\n    \"inputs\": {\n      \"filename_prefix\": \"tts\",\n      \"quality\": \"320k\",\n      \"audioUI\": \"\",\n      \"audio\": [\n        \"42\",\n        0\n      ]\n    },\n    \"class_type\": \"SaveAudioMP3\",\n    \"_meta\": {\n      \"title\": \"Save Audio (MP3)\"\n    }\n  },\n  \"211\": {\n    \"inputs\": {\n      \"multi_line_prompt\": \"æ—ç™½2\"\n    },\n    \"class_type\": \"MultiLinePromptIndex\",\n    \"_meta\": {\n      \"title\": \"å¤šè¡Œæ–‡æœ¬æ¡†\"\n    }\n  },\n  \"212\": {\n    \"inputs\": {\n      \"top_k\": 30,\n      \"top_p\": 0.8000000000000002,\n      \"temperature\": 0.8000000000000002,\n      \"num_beams\": 3,\n      \"max_mel_tokens\": 1500,\n      \"max_text_tokens_per_sentence\": 120,\n      \"custom_cuda_kernel\": false,\n      \"deepspeed\": false,\n      \"unload_model\": true,\n      \"emo_alpha\": 1.0000000000000002,\n      \"emo_vector\": \"\",\n      \"use_emo_text\": false,\n      \"emo_text\": \"\",\n      \"use_random\": false,\n      \"emo_alpha_s2\": 1.0000000000000002,\n      \"emo_vector_s2\": \"\",\n      \"use_emo_text_s2\": false,\n      \"emo_text_s2\": \"\",\n      \"use_random_s2\": false,\n      \"audio\": [\n        \"11\",\n        0\n      ],\n      \"text\": [\n        \"211\",\n        0\n      ]\n    },\n    \"class_type\": \"IndexTTS2Run\",\n    \"_meta\": {\n      \"title\": \"IndexTTS2 Run\"\n    }\n  },\n  \"214\": {\n    \"inputs\": {\n      \"filename_prefix\": \"tts\",\n      \"quality\": \"320k\",\n      \"audioUI\": \"\",\n      \"audio\": [\n        \"212\",\n        0\n      ]\n    },\n    \"class_type\": \"SaveAudioMP3\",\n    \"_meta\": {\n      \"title\": \"Save Audio (MP3)\"\n    }\n  },\n  \"215\": {\n    \"inputs\": {\n      \"image\": \"pasted/f6cfdfa0498ecb5c12785bbdb614b3bb082bd750808bb151ce66e12e1c6d3a0e.png\"\n    },\n    \"class_type\": \"LoadImage\",\n    \"_meta\": {\n      \"title\": \"åŠ è½½å›¾åƒ\"\n    }\n  }\n}",
              "type": "object"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1216,
        1120
      ],
      "id": "32533686-f344-45fa-b150-1b85a5a57a9d",
      "name": "è®¾ç½®å‚æ•°-æ—ç™½-éŸ³ç”»åŒæ­¥1"
    },
    {
      "parameters": {
        "resource": "file",
        "inputType": "binary"
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        320,
        1120
      ],
      "id": "61ee386f-bdc3-47c5-b414-83e4983d1ac8",
      "name": "Upload a file",
      "credentials": {
        "googlePalmApi": {
          "id": "3MWVuYUNo00zvNCn",
          "name": "Google Gemini(PaLM) Api ä»˜è´¹"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "93d8550b-00df-4566-95d5-363c4adb7971",
              "name": "è§†é¢‘åˆ†ææç¤ºè¯",
              "value": "=è§’è‰²ï¼šçŸ­è§†é¢‘æ—ç™½å¯¼æ¼”â€”â€”â€œç¥å½¢å…¼å¤‡â€çš„è¯­è¨€è‰ºæœ¯å¤§å¸ˆ\næ‚¨æ˜¯ä¸€ä½è¿½æ±‚â€œç¥å½¢å…¼å¤‡â€çš„çŸ­è§†é¢‘æ—ç™½å¯¼æ¼”ï¼Œæ›´æ˜¯ä¸€ä½èƒ½å®Œç¾å¤åˆ»å¹¶å‡ååŸä½œé£æ ¼çš„è¯­è¨€å¤§å¸ˆã€‚æ‚¨çš„ä½¿å‘½ï¼Œæ˜¯åœ¨â€œéŸ³ç”»åŒæ­¥â€å’Œâ€œå­—æ•°é™åˆ¶â€è¿™ä¸¤ä¸ªç»å¯¹çš„æŠ€æœ¯æ¡†æ¶å†…ï¼Œå¯¹æ—ç™½åˆç¨¿è¿›è¡Œä¸€åœºä»¥â€œé£æ ¼å»¶ç»­â€ä¸ºæ ¸å¿ƒçµé­‚çš„è‰ºæœ¯å†åˆ›ä½œã€‚æ‚¨çš„æ¯ä¸€æ¬¡ä¿®æ”¹ï¼Œéƒ½æ˜¯ä¸ºäº†è®©æœ€ç»ˆçš„æ—ç™½å¬èµ·æ¥ä¸åƒæ˜¯è¢«ä¿®æ”¹è¿‡ï¼Œè€Œåƒæ˜¯åŸä½œè€…åœ¨ä¸åŒå¿ƒå¢ƒä¸‹çš„äº²è‡ªæ¶¦è‰²ã€‚\n\nåˆ›ä½œæ ¸å¿ƒåŸåˆ™ (The Creative Iron Triangle)\næ‚¨çš„æ‰€æœ‰å·¥ä½œéƒ½å¿…é¡»å»ºç«‹åœ¨è¿™ä¸‰ä¸ªç¯ç¯ç›¸æ‰£ã€ä¼˜å…ˆçº§æ˜ç¡®çš„åŸåˆ™ä¹‹ä¸Šï¼š\n\néŸ³ç”»åŒæ­¥ï¼ˆç»å¯¹åŸºçŸ³ï¼‰\nè¿™æ˜¯ç‰©ç†ä¸–ç•Œçš„é“å¾‹ï¼Œä¸å¯æ’¼åŠ¨ã€‚æ—ç™½æè¿°çš„ä»»ä½•å…ƒç´ éƒ½å¿…é¡»ä¸ç”»é¢å‡ºç°çš„æ—¶åˆ»ç²¾å‡†å¯¹åº”ã€‚è¿™æ˜¯æ‰€æœ‰è‰ºæœ¯åˆ›ä½œçš„æŠ€æœ¯åœ°åŸºã€‚\n\nå­—æ•°é€‚é…ï¼ˆåˆšæ€§æ¡†æ¶ï¼‰\nè¿™æ˜¯ä»»åŠ¡çš„ç¡¬æ€§æŒ‡æ ‡ï¼Œæ²¡æœ‰å•†é‡ä½™åœ°ã€‚æ‚¨å¿…é¡»åœ¨ç›®æ ‡å­—æ•°èŒƒå›´å†…ï¼Œä»¥è‡ªç„¶çš„è¯­é€Ÿå®Œæˆæ’­æŠ¥ã€‚è¿™æ˜¯æ‚¨æ–½å±•æ‰åçš„è¾¹ç•Œã€‚\n\né£æ ¼å»¶ç»­ï¼ˆåˆ›ä½œçµé­‚ï¼‰\nè¿™æ˜¯è¡¡é‡æ‚¨å·¥ä½œæˆè´¥çš„æœ€é«˜è‰ºæœ¯æ ‡å‡†ã€‚åœ¨æ»¡è¶³å‰ä¸¤ä¸ªæ¡ä»¶åï¼Œæ‚¨çš„æ ¸å¿ƒä»»åŠ¡å°±æ˜¯æ·±å…¥ç†è§£ã€æ¨¡ä»¿å¹¶å»¶ç»­åˆç¨¿çš„è¯­è¨€é£æ ¼â€”â€”åŒ…æ‹¬å…¶ç‹¬ç‰¹çš„è¯­æ„Ÿã€è¯æ±‡åå¥½ã€å¥å¼ç»“æ„ã€èŠ‚å¥éŸµå¾‹å’Œæƒ…æ„ŸåŸºè°ƒã€‚æ‚¨çš„ç›®æ ‡æ˜¯â€œç¥ä¼¼â€å¤§äºâ€œå½¢ä¼¼â€ã€‚\n\næ ¸å¿ƒä»»åŠ¡ (Core Mission)\næ·±åº¦è§£è¯»è§†é¢‘åˆ†é•œï¼Œå°†ä¸€ä»½æ—ç™½åˆç¨¿ï¼Œå‡åä¸ºä¸‰ç‰ˆå¬æ„Ÿä¸åŒä½†çµé­‚ç»Ÿä¸€çš„æœ€ç»ˆæ–‡æ¡ˆã€‚æ¯ä¸€ç‰ˆéƒ½å¿…é¡»ï¼š\n\nä½¿ç”¨æŒ‡å®šçš„ æ—ç™½è¯­è¨€ è¿›è¡Œåˆ›ä½œã€‚\nä¸ç”»é¢å¤©è¡£æ— ç¼ã€‚\nä¸¥æ ¼ç¬¦åˆå„è‡ªçš„å­—æ•°è¦æ±‚ã€‚\nå¬èµ·æ¥å®Œå…¨å°±åƒæ˜¯åŸä½œè€…çš„æ‰‹ç¬”ï¼Œåªæ˜¯ä¸ºé€‚é…ä¸åŒèŠ‚å¥è€Œåšçš„ç²¾å¿ƒè°ƒæ•´ã€‚\nå·¥ä½œæµç¨‹ä¸å…·ä½“è¦æ±‚\n1. æ·±åº¦åˆ†æï¼šæ²‰æµ¸ä¸æ´å¯Ÿ\nè§†é¢‘æ‹‰ç‰‡ï¼šé€å¸§è§£æ„ç”»é¢ï¼Œä¸ä»…è¦çœ‹æ¸…â€œæ˜¯ä»€ä¹ˆâ€ï¼Œæ›´è¦çœ‹æ‡‚â€œä¸ºä»€ä¹ˆâ€ã€‚æ•æ‰å…³é”®åŠ¨ä½œã€æƒ…ç»ªè½¬æŠ˜ã€é•œå¤´è¯­è¨€å’Œä¸€åˆ‡èƒ½æ¿€å‘æƒ…æ„Ÿçš„æ ¸å¿ƒè§†è§‰å…ƒç´ ã€‚\né£æ ¼è§£æ„ï¼šç²¾è¯»æ—ç™½åˆç¨¿ä¸â€œå®Œæ•´åˆ†é•œè„šæœ¬â€ï¼Œå‰–æå…¶è¯­è¨€é£æ ¼ã€‚æ˜¯å†·é™å®¢è§‚ï¼Œè¿˜æ˜¯çƒ­æƒ…æ´‹æº¢ï¼Ÿæ˜¯ç®€æ´æœ‰åŠ›ï¼Œè¿˜æ˜¯åä¸½ç¹å¤ï¼Ÿç”¨è¯æ˜¯ä¹¦é¢åŒ–ï¼Œè¿˜æ˜¯å£è¯­åŒ–ï¼Ÿå°†è¿™äº›é£æ ¼åŸºå› é“­è®°äºå¿ƒã€‚\næ–‡è„‰è¡”æ¥ï¼šå®¡è§†å‰ååˆ†é•œçš„æ—ç™½ï¼Œç¡®ä¿æ‚¨çš„ä»»ä½•ä¿®æ”¹éƒ½èƒ½åœ¨é€»è¾‘ã€èŠ‚å¥å’Œæƒ…æ„Ÿä¸Šä¸ä¸Šä¸‹æ–‡å®Œç¾èåˆï¼Œå¦‚æ‹¼å›¾èˆ¬ä¸¥ä¸åˆç¼ã€‚\n2. é£æ ¼åŒ–ç²¾ä¿®ï¼šæˆ´ç€é•£é“çš„èˆè¹ˆ\né’ˆå¯¹æ¯ä¸€ç»„å­—æ•°è¦æ±‚ï¼Œåœ¨æŒ‡å®šçš„ æ—ç™½è¯­è¨€ ç¯å¢ƒä¸‹ï¼Œè¿›è¡Œä¸€æ¬¡ç‹¬ç«‹çš„ã€ä»¥é£æ ¼å»¶ç»­ä¸ºæ ¸å¿ƒçš„åˆ›ä½œï¼š\n\nåŸºè°ƒç¡®ç«‹ï¼šæ‰€æœ‰ä¿®æ”¹éƒ½å¿…é¡»å›´ç»•åˆç¨¿çš„æ ¸å¿ƒä¿¡æ¯ä¸é£æ ¼åŸºè°ƒå±•å¼€ã€‚\nä»¥é£æ ¼é©±åŠ¨ä¿®æ”¹ï¼š\nè°ƒæ•´è¯­åº/æ›¿æ¢è¯æ±‡ï¼šå½“ä¸ºäº†å¯¹é½ç”»é¢èŠ‚ç‚¹è€Œå¿…é¡»ä¿®æ”¹æ—¶ï¼Œä»æ‚¨çš„â€œé£æ ¼åŸºå› åº“â€ä¸­ï¼ŒæŒ‘é€‰å‡ºæœ€ç¬¦åˆåŸä½œè€…è¯­æ„Ÿçš„è¯æ±‡å’Œå¥å¼æ¥å®Œæˆæ›¿æ¢ã€‚\nå¢åˆ å†…å®¹ï¼š\néœ€è¦å¢åŠ å­—æ•°æ—¶ï¼šæ€è€ƒâ€œå¦‚æœåŸä½œè€…æƒ³è¯´å¾—æ›´è¯¦ç»†ï¼Œä»–ä¼šå¦‚ä½•æè¿°ï¼Ÿâ€ã€‚ç”¨ä»–çš„å£å»å»è¡¥å……ç»†èŠ‚ã€æ¸²æŸ“æƒ…ç»ªã€æ·±åŒ–æ„å¢ƒã€‚\néœ€è¦å‡å°‘å­—æ•°æ—¶ï¼šæ€è€ƒâ€œå¦‚æœåŸä½œè€…å¿…é¡»è¨€ç®€æ„èµ…ï¼Œä»–ä¼šä¿ç•™å“ªäº›æ ¸å¿ƒè¯æ±‡å’Œæ ‡å¿—æ€§å¥å¼ï¼Ÿâ€ã€‚è¿›è¡Œé£æ ¼åŒ–çš„ç²¾ç‚¼ï¼Œè€Œä¸æ˜¯ç®€å•ç²—æš´åœ°åˆ é™¤ã€‚\nä¸€è‡´æ€§æ£€éªŒï¼šåœ¨æ¯ä¸€ç‰ˆå®Œæˆåï¼Œåå¤è¯µè¯»ï¼Œæ£€æŸ¥å…¶å¬æ„Ÿæ˜¯å¦ä¸åˆç¨¿çš„çµé­‚ä¿æŒé«˜åº¦ä¸€è‡´ã€‚\nå‹å·åç§°è§„èŒƒï¼šè¯·é¿å…åœ¨å‹å·åç§°ä¸­ä½¿ç”¨è¿æ¥ç¬¦ï¼ˆå¦‚è¿å­—ç¬¦â€˜-â€™ï¼‰ï¼Œç»Ÿä¸€é‡‡ç”¨ç´§å‡‘æ ¼å¼ã€‚ä¾‹å¦‚ï¼šä½¿ç”¨ â€˜B2â€™ è€Œé â€˜B-2â€™ã€‚\n3. ç”Ÿæˆæœ€ç»ˆè¯­éŸ³åˆæˆæ–‡æ¡ˆ - æ ¼å¼åŒ–è§„åˆ™\næ¯ä¸€ç‰ˆç²¾ä¿®åçš„æ—ç™½ï¼Œå¦‚æœ‰å¿…è¦å¯æŒ‰ç…§ä»¥ä¸‹è¯¦ç»†çš„AIè¯­éŸ³å¼•æ“è§„åˆ™è¿›è¡Œæœ€ç»ˆæ ¼å¼åŒ–ï¼Œä»¥æ³¨å…¥æ›´çœŸå®è‡ªç„¶çš„å¬æ„Ÿã€‚ï¼ˆæŒ‰éœ€è®¾ç½®ï¼‰\n\nA. éŸ³ç´ æ§åˆ¶ (Phoneme Control) - ä¸»è¦é€‚ç”¨äºä¸­æ–‡ç­‰è¯­è¨€\næ­¤åŠŸèƒ½ç”¨äºä¸»åŠ¨æ ¡å‡†æ±‰å­—çš„ç²¾ç¡®å‘éŸ³ã€‚\n\nåŸºæœ¬æ ¼å¼ï¼šä½¿ç”¨ <|phoneme_start|> å’Œ <|phoneme_end|> åŒ…è£¹æ±‰å­—çš„æ‹¼éŸ³ï¼ˆå¸¦å£°è°ƒï¼‰ã€‚æ¯å€‹æ ‡ç­¾åŒ…å«ä¸€ä¸ªå•è¯æˆ–å­—æ¯ã€‚\nç¤ºä¾‹ï¼šæˆ‘æ˜¯ä¸€ä¸ª<|phoneme_start|>gong1<|phoneme_end|><|phoneme_start|>cheng2<|phoneme_end|><|phoneme_start|>shi1<|phoneme_end|>ã€‚\nB. å‰¯è¯­è¨€æ§åˆ¶ (Paralanguage)\næ­¤åŠŸèƒ½ç”¨äºå¢åŠ è‡ªç„¶è¯­éŸ³æ•ˆæœå’Œåœé¡¿ã€‚\n\nåœé¡¿è¯ï¼šå¯ç”¨â€œå—¯â€ã€â€œå•Šâ€ã€â€œumâ€ã€â€œuhâ€ç­‰ã€‚\nç‰¹æ®Šæ•ˆæœï¼ˆæ‹¬å·æ ‡æ³¨ï¼‰ï¼š\n(break)ï¼šçŸ­æš‚åœé¡¿\n(long-break)ï¼šé•¿æš‚åœé¡¿\n(breath)ï¼šå‘¼å¸å£°\nè¾“å‡ºæ ¼å¼\nè¯·ä¸¥æ ¼æŒ‰ç…§ä¸‹è¿°JSON æ ¼å¼è¾“å‡ºï¼Œä»…è¾“å‡º JSON å¯¹è±¡ï¼Œæ— éœ€ä»»ä½•é¢å¤–è§£é‡Šæˆ–è¯´æ˜ã€‚JSON çš„é”®ï¼ˆnarration_v1, narration_v2, narration_v3ï¼‰åº”ä¸è¾“å…¥çš„ä¸‰ç»„å­—æ•°è¦æ±‚ä¸€ä¸€å¯¹åº”ã€‚å¹¶ä¸”è¦ä¸¥æ ¼æŒ‰ç…§æ—ç™½è¯­è¨€è¦æ±‚ç”Ÿæˆï¼Œä¸è¦ä¸­è‹±æ–‡æ··åˆã€‚\n\n<JSON>\n{\n  \"narration_v1\": \"æ­¤å¤„ä¸ºç¬¦åˆç¬¬ä¸€ç»„å­—æ•°è¦æ±‚ï¼Œä¸”ä¸¥æ ¼éµå¾ªä¸Šè¿°æ‰€æœ‰åŸåˆ™åˆ›ä½œçš„æ—ç™½æ–‡æ¡ˆã€‚\",\n  \"narration_v2\": \"æ­¤å¤„ä¸ºç¬¦åˆç¬¬äºŒç»„å­—æ•°è¦æ±‚ï¼Œä¸”ä¸¥æ ¼éµå¾ªä¸Šè¿°æ‰€æœ‰åŸåˆ™åˆ›ä½œçš„æ—ç™½æ–‡æ¡ˆã€‚\",\n  \"narration_v3\": \"æ­¤å¤„ä¸ºç¬¦åˆç¬¬ä¸‰ç»„å­—æ•°è¦æ±‚ï¼Œä¸”ä¸¥æ ¼éµå¾ªä¸Šè¿°æ‰€æœ‰åŸåˆ™åˆ›ä½œçš„æ—ç™½æ–‡æ¡ˆã€‚\"\n}\nè¾“å…¥ä¿¡æ¯\nä»¥ä¸‹æ˜¯æ‚¨å°†æ¥æ”¶åˆ°çš„ä»»åŠ¡æ•°æ®ï¼Œç”¨äºæŒ‡å¯¼æ‚¨çš„åˆ›ä½œï¼š\n\nåˆ†é•œè§†é¢‘ç‰‡æ®µ: {{ $json.fileUri }}\néœ€ä¼˜åŒ–åˆ†é•œ ID: {{ $('Loop Over Items').item.json.scene_id }}\nå½“å‰åˆ†é•œæ—¶é•¿: {{ $('Loop Over Items').item.json.duration_seconds }}ç§’\næ—ç™½è¯­è¨€: ä¸­æ–‡\næ—ç™½å­—æ•°è¦æ±‚: { \"v1\": {{ $('Loop Over Items').item.json.duration_seconds *4 }} \"v2\": {{ $('Loop Over Items').item.json.duration_seconds *4.5 }}, \"v3\": {{ $('Loop Over Items').item.json.duration_seconds *5.5 }} }\nå½“å‰åˆ†é•œæ—ç™½ä¸­æ–‡åˆç¨¿: {{ $('Loop Over Items').item.json.naration_chinese_content }}\nå½“å‰åˆ†é•œæ—ç™½è‹±æ–‡åˆç¨¿: {{ $('Loop Over Items').item.json.narration_english_content }}\nå®Œæ•´åˆ†é•œä¸­æ–‡è„šæœ¬: {{ $('Loop Over Items').item.json.chinese_prompt }}\nå®Œæ•´åˆ†é•œè‹±æ–‡è„šæœ¬: {{ $('Loop Over Items').item.json.english_prompt }}",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        544,
        1120
      ],
      "id": "377eca81-1d58-4112-b75d-e537f8757e2a",
      "name": "è®¾ç½®å‚æ•°-éŸ³ç”»åŒæ­¥æç¤ºè¯"
    },
    {
      "parameters": {
        "operation": "write",
        "fileName": "={{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/00{{ $('Loop Over Items').item.json.scene_id }}.mp4",
        "options": {}
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        176,
        1632
      ],
      "id": "570613ec-4266-4ab2-8120-16306398f7ac",
      "name": "Read/Write Files from Disk3"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "numberInputs": 4,
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        848,
        2048
      ],
      "id": "d5ca7def-03a4-4e01-8880-d054bb761653",
      "name": "Merge2"
    },
    {
      "parameters": {
        "inputPath": "={{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/00{{ $('Loop Over Items').item.json.scene_id }}.mp4"
      },
      "type": "n8n-nodes-klib-ffmpeg.ffprobe",
      "typeVersion": 1,
      "position": [
        400,
        1632
      ],
      "id": "1e337ca9-c129-4933-aeca-02c7ccfefb77",
      "name": "FFprobe3"
    },
    {
      "parameters": {
        "command": "=mkdir -p \"{{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/Video/merged\""
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        -272,
        1632
      ],
      "id": "46db57ca-7bf2-4560-b54f-a31f74a3c4e5",
      "name": "8.2-æŒ‰æ—¥æœŸå»ºç«‹æ–‡ä»¶å¤¹1",
      "executeOnce": true,
      "retryOnFail": false
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "c3fa2d68-c6b6-497e-9659-0aad92ae572c",
              "leftValue": "={{ $json.candidates[0].content.parts[0].text }}",
              "rightValue": "={{ $json.candidates[0].content.parts[0].text }}",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        992,
        1120
      ],
      "id": "edaeb2a3-b8a1-4699-892e-754f25a9cb34",
      "name": "If4"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -48,
        1632
      ],
      "id": "a11e5e2d-0d01-462e-8450-e4a19eddb6e3",
      "name": "Merge3"
    },
    {
      "parameters": {
        "jsCode": "// è¾…åŠ©å‡½æ•°ï¼šéªŒè¯æ—¶é•¿æ˜¯å¦æ˜¯æœ‰æ•ˆçš„æ•°å­—ä¸”å¤§äº 0\nconst isValidDuration = (value) => {\n  return typeof value === 'number' && !isNaN(value) && value > 0;\n};\n\n// è¾…åŠ©å‡½æ•°ï¼šä»å®Œæ•´è·¯å¾„ä¸­æå–æ–‡ä»¶å\nconst getFilenameFromPath = (path) => {\n  if (!path) return null;\n  const lastSlashIndex = path.lastIndexOf('/');\n  if (lastSlashIndex === -1) {\n    // å¦‚æœæ²¡æœ‰æ–œæ ï¼Œåˆ™è·¯å¾„æœ¬èº«å°±æ˜¯æ–‡ä»¶å\n    return path;\n  }\n  return path.substring(lastSlashIndex + 1);\n};\n\n\n// 1. è·å–å¹¶è½¬æ¢ç›®æ ‡è§†é¢‘æ—¶é•¿ (FFprobe)\n// é¦–å…ˆè·å–ç›®æ ‡è§†é¢‘çš„å®Œæ•´å¯¹è±¡ï¼Œä»¥ä¾¿åŒæ—¶è·å– duration å’Œ inputPath\nconst targetVideoSource = $('è·å–è§†é¢‘æ—¶é•¿').first();\n\n// è·å–åŸå§‹å€¼ï¼Œå®ƒå¯èƒ½æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ \"5.062500\"ï¼‰\nconst rawTargetValue = targetVideoSource?.json?.data?.streams?.[0]?.duration;\n// è·å–ç›®æ ‡è§†é¢‘çš„ inputPath\nconst targetVideoInputPath = targetVideoSource?.json?.inputPath;\n// è®¡ç®—ç›®æ ‡è§†é¢‘çš„æ–‡ä»¶å\nconst targetVideoFilename = getFilenameFromPath(targetVideoInputPath);\n\n// å°è¯•å°†åŸå§‹å€¼è½¬æ¢ä¸ºæµ®ç‚¹æ•°ï¼Œä»¥ä¾¿è¿›è¡Œæ•°å€¼æ¯”è¾ƒ\nconst target = parseFloat(rawTargetValue);\n\n// é¦–å…ˆæ£€æŸ¥ç›®æ ‡æ—¶é•¿æœ¬èº«æ˜¯å¦æœ‰æ•ˆã€‚\n// å¦‚æœç›®æ ‡æ—¶é•¿æ— æ•ˆï¼Œåç»­çš„æ¯”è¾ƒå°±æ²¡æœ‰æ„ä¹‰ã€‚\nif (!isValidDuration(target)) {\n  return {\n    json: {\n      targetVideoDuration: rawTargetValue, // æ˜¾ç¤ºåŸå§‹çš„ã€å¯èƒ½æ— æ•ˆçš„å€¼\n      targetVideoInputPath: targetVideoInputPath,\n      targetVideoFilename: targetVideoFilename,\n      bestMatch: null,\n      videoSoundRatio: null, // æ— æ³•è®¡ç®—æ¯”å€¼\n      bestMatchFilename: null, // æ— æ³•è®¡ç®—\n      message: `ç›®æ ‡è§†é¢‘ (${targetVideoFilename || 'æœªçŸ¥æ–‡ä»¶'}) æ—¶é•¿æ— æ•ˆï¼Œæ— æ³•è¿›è¡Œæ¯”è¾ƒã€‚è¯·æ£€æŸ¥FFprobeè¾“å‡ºæ˜¯å¦ä¸ºæœ‰æ•ˆæ•°å­—ã€‚`,\n      soundCandidates: [] // æ²¡æœ‰æœ‰æ•ˆå€™é€‰ï¼Œæ‰€ä»¥æ˜¯ç©ºæ•°ç»„\n    }\n  };\n}\n\n// 2. è·å–å¹¶å‡†å¤‡ä¸‰ä¸ªå£°éŸ³æ—¶é•¿å€™é€‰\n// ä½¿ç”¨æ­£ç¡®çš„è·¯å¾„æ¥è·å–å£°éŸ³æ—¶é•¿ï¼Œå¹¶åŒæ—¶è·å– inputPath å’Œæ—ç™½ (narration)\nconst soundCandidates = [\n  {\n    source: 'å£°éŸ³æ—¶é•¿-1',\n    // è·å–æ•´ä¸ª JSON å¯¹è±¡ï¼Œæ–¹ä¾¿åç»­æå– duration, inputPath å’Œ narration\n    data: $('å£°éŸ³æ—¶é•¿-2').first()?.json\n  },\n  {\n    source: 'å£°éŸ³æ—¶é•¿-2',\n    data: $('å£°éŸ³æ—¶é•¿-3').first()?.json\n  },\n  {\n    source: 'å£°éŸ³æ—¶é•¿-3',\n    data: $('å£°éŸ³æ—¶é•¿-1').first()?.json\n  }\n];\n\n// 3. å‡†å¤‡ç”¨äºæ¯”è¾ƒçš„æ•°æ®ç»“æ„\nlet bestMatch = null;      // ç”¨äºå­˜å‚¨æœ€ä½³åŒ¹é…çš„ç»“æœ\nlet minDiff = Infinity;    // ç”¨äºè·Ÿè¸ªæœ€å°çš„å·®å€¼ï¼Œåˆå§‹è®¾ä¸ºæ— é™å¤§\nlet processedSoundCandidates = []; // ç”¨äºå­˜å‚¨æ‰€æœ‰å¤„ç†è¿‡çš„å€™é€‰åŠå…¶çŠ¶æ€ï¼Œæ–¹ä¾¿è°ƒè¯•\n\n// 4. éå†å£°éŸ³æ—¶é•¿å€™é€‰ï¼Œè®¡ç®—å·®å€¼å¹¶æ‰¾åˆ°æœ€ä½³åŒ¹é…\nfor (const candidate of soundCandidates) {\n  const rawValue = candidate.data?.data?.streams?.[0]?.duration;\n  const inputPath = candidate.data?.inputPath;\n  // ï¼ï¼ä¿®æ”¹æ­¤å¤„ï¼ï¼\n  // å°è¯•ä½¿ç”¨å­—ç¬¦ä¸² \"'æ—ç™½'\" ä½œä¸ºé”®æ¥æå–æ—ç™½ä¿¡æ¯ï¼Œ\n  // è¿™æ˜¯æ ¹æ®ç”¨æˆ·æç¤º `$input.first().json['\\'æ—ç™½\\''].narration_v` æ¨æ–­çš„ã€‚\n  const narration = candidate.data?.[\"'æ—ç™½'\"]?.narration_v;\n\n\n  // å°è¯•å°†å£°éŸ³æ—¶é•¿çš„åŸå§‹å€¼è½¬æ¢ä¸ºæµ®ç‚¹æ•°\n  const parsedValue = parseFloat(rawValue);\n  // æ£€æŸ¥è½¬æ¢åçš„å€¼æ˜¯å¦æœ‰æ•ˆ\n  const isValid = isValidDuration(parsedValue);\n  let diff = Infinity; // é»˜è®¤å·®å€¼è®¾ä¸ºæ— é™å¤§\n\n  // å¦‚æœå£°éŸ³æ—¶é•¿æœ‰æ•ˆï¼Œåˆ™è®¡ç®—å…¶ä¸ç›®æ ‡è§†é¢‘æ—¶é•¿çš„ç»å¯¹å·®å€¼\n  if (isValid) {\n    diff = Math.abs(parsedValue - target);\n  }\n\n  // è®°å½•å¤„ç†åçš„å€™é€‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬åŸå§‹å€¼ã€è½¬æ¢åçš„å€¼ã€æ˜¯å¦æœ‰æ•ˆå’Œå·®å€¼\n  // è¿™å¯¹äºè°ƒè¯•å’Œç†è§£æ¯ä¸ªå€™é€‰çš„çŠ¶æ€éå¸¸æœ‰å¸®åŠ©\n  processedSoundCandidates.push({\n    source: candidate.source,      // æ¥æºæ ‡è¯†ï¼ˆä¾‹å¦‚ 'å£°éŸ³æ—¶é•¿-1'ï¼‰\n    rawValue: rawValue,            // åŸå§‹è·å–åˆ°çš„å€¼ï¼ˆå¯èƒ½æ˜¯å­—ç¬¦ä¸²ï¼‰\n    parsedValue: parsedValue,      // è½¬æ¢åçš„æ•°å­—å€¼ï¼ˆæˆ– NaN å¦‚æœè½¬æ¢å¤±è´¥ï¼‰\n    isValid: isValid,              // æ ‡è®°æ­¤æ—¶é•¿æ˜¯å¦è¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆçš„\n    diff: diff,                    // ä¸ç›®æ ‡æ—¶é•¿çš„å·®å€¼ï¼ˆå¦‚æœæœ‰æ•ˆï¼‰\n    inputPath: inputPath,          // å­˜å‚¨ inputPath\n    narration: narration           // å­˜å‚¨æå–åˆ°çš„æ—ç™½\n  });\n\n  // å¦‚æœå½“å‰å€™é€‰æœ‰æ•ˆï¼Œå¹¶ä¸”å…¶å·®å€¼å°äºç›®å‰æ‰¾åˆ°çš„æœ€å°å·®å€¼\n  if (isValid && diff < minDiff) {\n    minDiff = diff; // æ›´æ–°æœ€å°å·®å€¼\n    // æ›´æ–°æœ€ä½³åŒ¹é…ä¿¡æ¯ï¼ŒåŒ…æ‹¬ inputPath å’Œ narration\n    bestMatch = {\n      source: candidate.source,  // æœ€ä½³åŒ¹é…çš„æ¥æº\n      value: parsedValue,        // æœ€ä½³åŒ¹é…çš„æ•°å€¼\n      diff: diff,                // æœ€ä½³åŒ¹é…ä¸ç›®æ ‡çš„å·®å€¼\n      inputPath: inputPath,      // å­˜å‚¨æœ€ä½³åŒ¹é…çš„ inputPath\n      narration: narration       // å­˜å‚¨æœ€ä½³åŒ¹é…çš„æ—ç™½\n    };\n  }\n}\n\n// 5. è®¡ç®—è§†é¢‘ä¸å£°éŸ³çš„æ¯”å€¼\nlet videoSoundRatio = null;\nlet bestMatchFilename = null;\n\nif (bestMatch && bestMatch.value > 0) { // ç¡®ä¿æ‰¾åˆ°äº†æœ€ä½³åŒ¹é…ä¸”å£°éŸ³æ—¶é•¿å¤§äº0ï¼Œé¿å…é™¤ä»¥é›¶\n  videoSoundRatio = target / bestMatch.value;\n  // å¦‚æœæ‰¾åˆ°äº†æœ€ä½³åŒ¹é…ï¼Œåˆ™æå–å…¶æ–‡ä»¶å\n  bestMatchFilename = getFilenameFromPath(bestMatch.inputPath);\n}\n\n// 6. æ„å»ºå¹¶è¿”å›ç»“æœ JSON\nif (bestMatch) {\n  // å¦‚æœæ‰¾åˆ°äº†æœ€ä½³åŒ¹é…\n  return {\n    json: {\n      targetVideoDuration: target, // è½¬æ¢åçš„æ•°å­—ç›®æ ‡å€¼\n      targetVideoInputPath: targetVideoInputPath,\n      targetVideoFilename: targetVideoFilename,\n      bestMatch: bestMatch,        // æœ€ä½³åŒ¹é…çš„è¯¦ç»†ä¿¡æ¯ (åŒ…å« inputPath å’Œ narration)\n      videoSoundRatio: videoSoundRatio, // è§†é¢‘ä¸æœ€ä½³åŒ¹é…å£°éŸ³æ—¶é•¿çš„æ¯”å€¼\n      bestMatchFilename: bestMatchFilename, // æœ€ä½³åŒ¹é…æ–‡ä»¶çš„æ–‡ä»¶å\n      soundCandidates: processedSoundCandidates, // æ‰€æœ‰å£°éŸ³æ—¶é•¿å€™é€‰çš„å¤„ç†ç»“æœ\n      message: `ç›®æ ‡è§†é¢‘ (${targetVideoFilename || 'æœªçŸ¥æ–‡ä»¶'}) æ—¶é•¿: ${target.toFixed(4)}ã€‚` +\n                 `æ‰¾åˆ°æœ€æ¥è¿‘çš„å£°éŸ³æ—¶é•¿ï¼š${bestMatch.source} (${bestMatchFilename || 'æœªçŸ¥æ–‡ä»¶'})ï¼Œå·®å€¼ä¸º ${bestMatch.diff.toFixed(4)}` +\n                 (videoSoundRatio !== null ? `, è§†é¢‘/å£°éŸ³æ¯”å€¼ä¸º ${videoSoundRatio.toFixed(4)}` : \"\") +\n                 (bestMatch.narration ? `, æ—ç™½å†…å®¹: \"${bestMatch.narration}\"` : \", æ²¡æœ‰æ‰¾åˆ°æ—ç™½å†…å®¹ã€‚\") // æ·»åŠ æ—ç™½ä¿¡æ¯\n    }\n  };\n} else {\n  // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœ‰æ•ˆçš„å£°éŸ³æ—¶é•¿è¿›è¡Œæ¯”è¾ƒï¼ˆæ‰€æœ‰å€™é€‰éƒ½æ— æ•ˆï¼‰\n  return {\n    json: {\n      targetVideoDuration: target, // è½¬æ¢åçš„æ•°å­—ç›®æ ‡å€¼\n      targetVideoInputPath: targetVideoInputPath,\n      targetVideoFilename: targetVideoFilename,\n      bestMatch: null,             // æ²¡æœ‰æ‰¾åˆ°æœ€ä½³åŒ¹é…\n      videoSoundRatio: null,       // æ— æ³•è®¡ç®—æ¯”å€¼\n      bestMatchFilename: null,     // æ— æ³•è®¡ç®—\n      soundCandidates: processedSoundCandidates, // æ‰€æœ‰å£°éŸ³æ—¶é•¿å€™é€‰çš„å¤„ç†ç»“æœ\n      message: `ç›®æ ‡è§†é¢‘ (${targetVideoFilename || 'æœªçŸ¥æ–‡ä»¶'}) æ—¶é•¿: ${target.toFixed(4)}ã€‚` +\n                 \"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœ‰æ•ˆçš„å£°éŸ³æ—¶é•¿è¿›è¡Œæ¯”è¾ƒã€‚\"\n    }\n  };\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1808,
        2976
      ],
      "id": "93213343-b80c-444d-b200-7f559e99af58",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "command": "=ffmpeg -y -i \"{{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/{{ $json.targetVideoFilename }}\" -vf \"setpts=PTS/{{ $json.videoSoundRatio }}\" -c:v libx264 -preset fast -crf 23 {{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/b-{{ $json.targetVideoFilename }}"
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        -1584,
        2976
      ],
      "id": "cd8a423e-da10-40e8-af6e-bdd4c86592d4",
      "name": "Execute Command2"
    },
    {
      "parameters": {
        "fileSelector": "={{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/Video/*mp4",
        "options": {}
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        -912,
        3600
      ],
      "id": "aa578906-0986-4a26-b9fd-b3df0ba75bc4",
      "name": "26-è¯»å–ç”Ÿæˆçš„è§†é¢‘ç”¨äºåˆå¹¶1",
      "executeOnce": true
    },
    {
      "parameters": {
        "jsCode": "// åœ¨ N8N çš„ Code èŠ‚ç‚¹ä¸­ï¼Œä½¿ç”¨ $input.all() æ¥è·å–æ‰€æœ‰è¾“å…¥é¡¹ã€‚\n// $input.all() è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ª N8N Item å¯¹è±¡ã€‚\n// æ¯ä¸ª Item å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª 'json' å±æ€§ï¼Œå…¶ä¸­åŒ…å«å®é™…çš„æ•°æ®ã€‚\n//\n// æ ¹æ®æ‚¨æä¾›çš„æœ€æ–° JSON æ•°æ®ï¼Œæ¯ä¸ª item.json çš„ç»“æ„æ˜¯ï¼š\n// {\n//   \"mimeType\": \"video/mp4\",\n//   \"fileType\": \"video\",\n//   \"fileName\": \"MMaudio_00008-audio.mp4\", // <-- æˆ‘ä»¬éœ€è¦ä»è¿™é‡Œè·å–æ–‡ä»¶å\n//   \"fileExtension\": \"mp4\",\n//   \"fileSize\": \"1.34 MB\"\n// }\n\n// 1. è·å–æ‰€æœ‰è¾“å…¥é¡¹ã€‚$input.all() è¿”å›ä¸€ä¸ª N8N Item æ•°ç»„ã€‚\nconst inputItems = $input.all();\n\n// 2. éå† inputItems æ•°ç»„ï¼Œæå–æ¯ä¸ª Item çš„ json å±æ€§ä¸­çš„ 'fileName'ï¼Œå¹¶æ ¼å¼åŒ–ã€‚\nconst ffmpegLines = inputItems.map(item => {\n  // è®¿é—® item.json ä¸­çš„ 'fileName' å±æ€§\n  const fileName = item.json && item.json.fileName;\n\n  // 3. å¥å£®æ€§æ£€æŸ¥ï¼šç¡®ä¿ 'fileName' å­˜åœ¨ä¸”æ˜¯å­—ç¬¦ä¸²ç±»å‹ã€‚\n  if (typeof fileName === 'string' && fileName.length > 0) {\n    // FFmpeg è¦æ±‚æ–‡ä»¶åç”¨å•å¼•å·åŒ…è£¹\n    return `file '${fileName}'`;\n  } else {\n    // å¦‚æœæŸä¸ª Item ç¼ºå°‘ 'fileName' æˆ–å…¶ç±»å‹ä¸æ­£ç¡®ï¼Œå¯ä»¥åœ¨æ§åˆ¶å°æ‰“å°è­¦å‘Šï¼Œ\n    // å¹¶è¿”å› nullï¼Œä»¥ä¾¿åç»­é€šè¿‡ filter æ–¹æ³•ç§»é™¤ã€‚\n    console.warn('è·³è¿‡æ­¤é¡¹ï¼Œå› ä¸ºç¼ºå°‘æˆ–æ— æ•ˆçš„ \"fileName\" å±æ€§:', item);\n    return null;\n  }\n}).filter(line => line !== null); // ç§»é™¤æ‰€æœ‰ null å€¼ï¼ˆå³è¢«è·³è¿‡çš„é¡¹ï¼‰\n\n// 4. å°†æ‰€æœ‰æœ‰æ•ˆçš„è¡Œç”¨æ¢è¡Œç¬¦è¿æ¥èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„å­—ç¬¦ä¸²ã€‚\nconst ffmpegListContent = ffmpegLines.join('\\n');\n\n// 5. N8N Code èŠ‚ç‚¹éœ€è¦è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªè¾“å‡º Itemã€‚\n//    è¿™é‡Œæˆ‘ä»¬è¿”å›ä¸€ä¸ªåŒ…å«å•ä¸ª Item çš„æ•°ç»„ï¼Œè¯¥ Item çš„ 'json' å±æ€§ä¸­åŒ…å«æˆ‘ä»¬ç”Ÿæˆçš„å­—ç¬¦ä¸²ã€‚\nreturn [{\n  json: {\n    // æ‚¨å¯ä»¥æ ¹æ®éœ€è¦ç»™è¿™ä¸ªå±æ€§å‘½åï¼Œä¾‹å¦‚ 'ffmpegList', 'fileListForFFmpeg' ç­‰ã€‚\n    ffmpegList: ffmpegListContent\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -688,
        3600
      ],
      "id": "cd462e54-b9a3-4435-beb5-acab73a8458e",
      "name": "27-åˆ¶ä½œåˆå¹¶åˆ—è¡¨1"
    },
    {
      "parameters": {
        "operation": "toText",
        "sourceProperty": "ffmpegList",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        -464,
        3600
      ],
      "id": "599c92a3-2aed-4f68-b44d-264262398639",
      "name": "28-åˆå¹¶åˆ—è¡¨è½¬æ¢ä¸ºTXTæ–‡ä»¶1"
    },
    {
      "parameters": {
        "operation": "write",
        "fileName": "={{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Edit Fields').item.json.video_title_chinese }}/Video/file.txt",
        "options": {}
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        -240,
        3600
      ],
      "id": "a0defb86-4639-412b-9933-e383b95708ff",
      "name": "29-å‚¨å­˜åˆå¹¶åˆ—è¡¨1"
    },
    {
      "parameters": {
        "command": "=ffmpeg -f concat -safe 0 -i {{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/Video/file.txt -c copy {{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/Video/merged/merged_audio.mp4"
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        -16,
        3600
      ],
      "id": "5d26ae8e-3acf-477f-86ea-f6bdabd2f57f",
      "name": "30-è§†é¢‘æ‹¼æ¥åˆæˆ1",
      "retryOnFail": false,
      "executeOnce": false,
      "alwaysOutputData": false,
      "notesInFlow": false
    },
    {
      "parameters": {
        "inputPath": "={{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/C-00{{ $('Loop Over Items').item.json.scene_id }}.mp4",
        "showInfo": [
          "streams"
        ]
      },
      "type": "n8n-nodes-klib-ffmpeg.ffprobe",
      "typeVersion": 1,
      "position": [
        -1136,
        2976
      ],
      "id": "627301f4-16c5-4316-a6fa-c754b1f62697",
      "name": "FFprobe4"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpQueryAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [\n    {\n      \"role\": \"user\",\n      \"parts\": [\n        {\n          \"fileData\": {\n            \"mimeType\": \"video/mp4\",\n            \"fileUri\": \"{{ $json.fileUri }}\"\n          }\n        },\n        {\n          \"text\": {{ JSON.stringify($('è®¾ç½®å‚æ•°-éŸ³ç”»åŒæ­¥æç¤ºè¯').item.json['è§†é¢‘åˆ†ææç¤ºè¯']) }}\n        }\n      ]\n    }\n  ],\n  \"generationConfig\": {\n    \"temperature\": 1\n  }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        768,
        1120
      ],
      "id": "9a088e37-2879-4c01-900b-ef40380bcce8",
      "name": "HTTP Request",
      "retryOnFail": true,
      "maxTries": 5,
      "credentials": {
        "httpQueryAuth": {
          "id": "zOzuNKUX0Bs0aTPH",
          "name": "Gemini ä»˜è´¹"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "content": "# 2 ç”Ÿå›¾",
        "height": 704,
        "width": 1472
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        224,
        80
      ],
      "typeVersion": 1,
      "id": "2a0c9c3e-200f-4b6e-96c1-86c545ece2c7",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "# 3 å›¾ç”Ÿè§†é¢‘",
        "height": 560,
        "width": 2224
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2208,
        864
      ],
      "typeVersion": 1,
      "id": "66e281a3-653b-46c6-b0e3-9f6cfbed6880",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "# 7 æœ€ç»ˆè§†é¢‘åˆæˆ",
        "height": 496,
        "width": 1232
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1024,
        3440
      ],
      "typeVersion": 1,
      "id": "135bb755-db71-453d-8e6e-72fb4d31f61c",
      "name": "Sticky Note2",
      "disabled": true
    },
    {
      "parameters": {
        "content": "# 1 åˆå§‹-æç¤ºè¯",
        "height": 688,
        "width": 1504
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1312,
        96
      ],
      "typeVersion": 1,
      "id": "eceae001-6558-4182-9509-68c678d88b52",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "content": "# 4 æ—ç™½ç”Ÿæˆæç¤ºè¯",
        "height": 512,
        "width": 1344
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        128,
        912
      ],
      "typeVersion": 1,
      "id": "6055bc30-00a5-4281-8149-8f41c3de9838",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "content": "# 6 è§†é¢‘éŸ³é¢‘åˆæˆ",
        "height": 784,
        "width": 3120
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1920,
        2512
      ],
      "typeVersion": 1,
      "id": "624f1eeb-5075-4435-bdc0-78515c3ae4ef",
      "name": "Sticky Note6",
      "disabled": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "b40e171c-a892-4f47-8429-ccd9b0f8f2f1",
              "name": "å›¾ç‰‡æç¤ºè¯",
              "value": "={{ $json.candidates[0].content.parts[0].text }}",
              "type": "object"
            },
            {
              "id": "c23dc096-a512-424d-89e6-9421e5571f3a",
              "name": "scene_id",
              "value": "={{ $('Loop Over Items').item.json.scene_id }}",
              "type": "number"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -16,
        2848
      ],
      "id": "027388cc-2731-4d99-90f7-dd4c9ec03f0a",
      "name": "è®¾ç½®å‚æ•°-æå–æç¤ºè¯1"
    },
    {
      "parameters": {
        "fieldToSplitOut": "['å›¾ç‰‡æç¤ºè¯'].scenes",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        208,
        2928
      ],
      "id": "f236dc9d-6050-4e55-8a8e-a0dc0c365f89",
      "name": "éå†1"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpQueryAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [\n    {\n      \"role\": \"user\",\n      \"parts\": [\n        {\n          \"fileData\": {\n            \"mimeType\": \"video/mp4\",\n            \"fileUri\": \"{{ $json.fileUri }}\"\n          }\n        },\n        {\n          \"text\": {{ JSON.stringify($('ä¸»è¦è®¾ç½®å‚æ•°').first().json['è§†é¢‘å­—å¹•æç¤ºè¯']) }}\n        }\n      ]\n    }\n  ],\n  \"generationConfig\": {\n    \"responseMimeType\": \"application/json\",\n    \"responseSchema\":{\n  \"type\": \"object\",\n  \"properties\": {\n    \"scenes\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"id\": {\n            \"type\": \"number\"\n          },\n          \"startTime\": {\n            \"type\": \"number\"\n          },\n          \"endTime\": {\n            \"type\": \"number\"\n          },\n          \"text\": {\n            \"type\": \"string\"\n          },\n          \"visual_context\": {\n            \"type\": \"string\"\n          },\n          \"scene_type\": {\n            \"type\": \"string\"\n          },\n          \"subtitle_zone_suggestion\": {\n            \"type\": \"string\"\n          },\n          \"visual_complexity\": {\n            \"type\": \"string\"\n          },\n          \"on_screen_obstacles\": {\n            \"type\": \"string\"\n          },\n          \"on_screen_text_content\": {\n            \"type\": \"string\"\n          },\n          \"is_inferred_speech\": {\n            \"type\": \"boolean\"\n          }\n        },\n        \"propertyOrdering\": [\n          \"id\",\n          \"startTime\",\n          \"endTime\",\n          \"text\",\n          \"visual_context\",\n          \"scene_type\",\n          \"subtitle_zone_suggestion\",\n          \"visual_complexity\",\n          \"on_screen_obstacles\",\n          \"on_screen_text_content\",\n          \"is_inferred_speech\"\n        ],\n        \"required\": [\n          \"id\",\n          \"startTime\",\n          \"endTime\",\n          \"text\",\n          \"visual_context\",\n          \"scene_type\",\n          \"subtitle_zone_suggestion\",\n          \"visual_complexity\",\n          \"on_screen_obstacles\",\n          \"on_screen_text_content\",\n          \"is_inferred_speech\"\n        ]\n      }\n    }\n  },\n  \"propertyOrdering\": [\n    \"scenes\"\n  ],\n  \"required\": [\n    \"scenes\"\n  ]\n}\n  }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -464,
        2976
      ],
      "id": "7f8a7a0c-2aff-4249-8026-51b9bd1b89cc",
      "name": "è§†é¢‘åˆ†æ1",
      "retryOnFail": true,
      "credentials": {
        "httpQueryAuth": {
          "id": "zOzuNKUX0Bs0aTPH",
          "name": "Gemini ä»˜è´¹"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "fileSelector": "={{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/C-00{{ $('Loop Over Items').item.json.scene_id }}.mp4",
        "options": {}
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        -912,
        2976
      ],
      "id": "f2b7eec3-670c-4e5d-9ab1-43c978d7e73e",
      "name": "Read/Write Files from Disk6"
    },
    {
      "parameters": {
        "resource": "file",
        "inputType": "binary"
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        -688,
        2976
      ],
      "id": "7421b673-81f3-4471-9092-c8539c88dc8d",
      "name": "Upload a file2",
      "credentials": {
        "googlePalmApi": {
          "id": "3MWVuYUNo00zvNCn",
          "name": "Google Gemini(PaLM) Api ä»˜è´¹"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// æ™ºèƒ½å­—å¹•NCAè¯·æ±‚ç”Ÿæˆå™¨ - ä¼˜åŒ–ç‰ˆæœ¬\nconst videoUrl = $('Upload a file2').first().json.fileUri; // æ ¹æ®ä½ çš„è¾“å…¥èŠ‚ç‚¹åç§°è°ƒæ•´\nconst allInputs = $input.all();\nconsole.log('è¾“å…¥é¡¹æ•°é‡:', allInputs.length);\n\n// ä»all()ç»“æœä¸­æå–å­—å¹•æ•°ç»„\nlet subtitleSegments = [];\n\nif (allInputs.length > 0 && allInputs[0].json.id !== undefined) {\n  subtitleSegments = allInputs.map(input => input.json);\n  console.log('ä½¿ç”¨æ–¹æ³•1: æ¯ä¸ªè¾“å…¥é¡¹ä¸ºå•ä¸ªå­—å¹•ç‰‡æ®µ');\n} else if (allInputs.length > 0) {\n  const firstInput = allInputs[0].json;\n  if (Array.isArray(firstInput)) {\n    subtitleSegments = firstInput;\n    console.log('ä½¿ç”¨æ–¹æ³•2: ç¬¬ä¸€ä¸ªè¾“å…¥é¡¹ä¸ºå®Œæ•´æ•°ç»„');\n  }\n}\n\nconsole.log('æœ€ç»ˆè·å–çš„å­—å¹•ç‰‡æ®µæ•°é‡:', subtitleSegments.length);\n\n// å­—å¹•ä½ç½®æ˜ å°„\nconst positionMapping = {\n  'bottom_center': 'h-100',\n  'top_center': '80',\n  'center': '(h-text_h)/2',\n  'bottom_left': 'h-100',\n  'bottom_right': 'h-100',\n  'top_left': '80',\n  'top_right': '80'\n};\n\n// æ ¹æ®è§†è§‰å¤æ‚åº¦è°ƒæ•´å­—ä½“å¤§å°\nfunction getFontSizeByComplexity(complexity, sceneType) {\n  const baseSizes = {\n    'low': 28,\n    'medium': 24,\n    'high': 20\n  };\n\n  if (sceneType === 'horror_reveal' || sceneType === 'explanation') {\n    return baseSizes[complexity] + 2;\n  }\n\n  return baseSizes[complexity] || 24;\n}\n\n// æ ¹æ®åœºæ™¯ç±»å‹é€‰æ‹©å­—ä½“é¢œè‰²å’Œæ ·å¼\nfunction getStyleByScene(sceneType) {\n  const styles = {\n    'explanation': {\n      fontColor: 'yellow',\n      boxColor: 'black@0.8',\n      emphasis: true\n    },\n    'horror_reveal': {\n      fontColor: 'red',\n      boxColor: 'black@0.9',\n      emphasis: true\n    },\n    'visual_illustration': {\n      fontColor: 'white',\n      boxColor: 'black@0.7',\n      emphasis: false\n    },\n    'narrative_flashback': {\n      fontColor: 'lightblue',\n      boxColor: 'black@0.7',\n      emphasis: false\n    },\n    'outro': {\n      fontColor: 'white',\n      boxColor: 'black@0.6',\n      emphasis: false\n    }\n  };\n\n  return styles[sceneType] || {\n    fontColor: 'white',\n    boxColor: 'black@0.7',\n    emphasis: false\n  };\n}\n\n// å¤„ç†æ–‡æœ¬ï¼Œä¼˜åŒ–æ˜¾ç¤º - ç§»é™¤é•¿åº¦é™åˆ¶\nfunction processSubtitleText(text) {\n  if (!text || text.trim() === '') return null;\n\n  // ç§»é™¤å¤šä½™ç©ºæ ¼å’Œç‰¹æ®Šå­—ç¬¦ï¼Œä¿®æ”¹æ­¤å¤„ä»¥æ”¯æŒä¸­æ–‡å­—ç¬¦\n  text = text.trim()\n    .replace(/\\s+/g, ' ')\n    .replace(/['\"]/g, '') // ç§»é™¤å¼•å·\n    .replace(/[^\\p{L}\\p{N}\\s.,!?-]/gu, ''); // !!! å…³é”®ä¿®æ”¹: å…è®¸Unicodeå­—æ¯å’Œæ•°å­—\n\n  // å¦‚æœæ–‡æœ¬è¿‡é•¿ï¼Œæ™ºèƒ½åˆ†è¡Œï¼ˆä¸é™åˆ¶é•¿åº¦ï¼‰\n  if (text.length > 60) {\n    const words = text.split(' ');\n    const lines = [];\n    let currentLine = '';\n\n    for (const word of words) {\n      if ((currentLine + ' ' + word).length <= 50) {\n        currentLine += (currentLine ? ' ' : '') + word;\n      } else {\n        if (currentLine) lines.push(currentLine);\n        currentLine = word;\n      }\n    }\n    if (currentLine) lines.push(currentLine);\n\n    // æœ€å¤š3è¡Œï¼Œè¶…å‡ºåˆ™æˆªæ–­\n    if (lines.length > 3) {\n      lines[2] = lines[2].substring(0, 47) + '...';\n      return lines.slice(0, 3).join('\\\\n');\n    }\n    return lines.join('\\\\n');\n  }\n\n  return text;\n}\n\n// ç”Ÿæˆå­—å¹•æ»¤é•œ - ä¼˜åŒ–ç‰ˆæœ¬\nfunction generateSubtitleFilter(segments) {\n  const subtitleFilters = [];\n\n  segments.forEach((segment, index) => {\n    // è·³è¿‡ç©ºæ–‡æœ¬æˆ–æ— å­—å¹•å»ºè®®çš„ç‰‡æ®µ\n    if (!segment.text ||\n        segment.text.trim() === '' ||\n        segment.subtitle_zone_suggestion === 'none') {\n      console.log(`è·³è¿‡ç‰‡æ®µ${index + 1}: ç©ºæ–‡æœ¬æˆ–æ— å­—å¹•å»ºè®®`);\n      return;\n    }\n\n    const {\n      startTime,\n      endTime,\n      text,\n      scene_type,\n      subtitle_zone_suggestion,\n      visual_complexity\n    } = segment;\n\n    // å¤„ç†æ–‡æœ¬\n    const processedText = processSubtitleText(text);\n    if (!processedText) {\n      console.log(`è·³è¿‡ç‰‡æ®µ${index + 1}: æ–‡æœ¬å¤„ç†åä¸ºç©º`);\n      return; // å¦‚æœæ–‡æœ¬å¤„ç†åä¸ºç©ºï¼Œåˆ™è·³è¿‡\n    }\n\n    // è·å–ä½ç½®\n    const yPosition = positionMapping[subtitle_zone_suggestion] || 'h-100';\n\n    // è·å–æ ·å¼\n    const style = getStyleByScene(scene_type);\n    const fontSize = getFontSizeByComplexity(visual_complexity, scene_type);\n\n    // å®‰å…¨å¤„ç†æ–‡æœ¬\n    const safeText = processedText.replace(/'/g, '');\n\n    // æ ¹æ®ä½ç½®è°ƒæ•´xåæ ‡\n    const xPosition = '(w-text_w)/2'; // å§‹ç»ˆå±…ä¸­\n\n    // æ·»åŠ ç‰¹æ•ˆ\n    let extraEffects = '';\n    if (style.emphasis) {\n      extraEffects = ':shadowcolor=black:shadowx=2:shadowy=2';\n    }\n\n    // ç”Ÿæˆå•ä¸ªdrawtextæ»¤é•œ\n    // *** å…³é”®ä¿®æ”¹ï¼šåœ¨è¿™é‡Œæ·»åŠ äº† fontfile å‚æ•° ***\n    const drawTextFilter = `drawtext=text='${safeText}':fontsize=${fontSize}:fontcolor=${style.fontColor}:x=${xPosition}:y=${yPosition}:enable='between(t,${startTime},${endTime})':box=1:boxcolor=${style.boxColor}:boxborderw=6:fontfile='SourceHanSansCN-Normal'${extraEffects}`;\n\n    subtitleFilters.push(drawTextFilter);\n\n    console.log(`ç”Ÿæˆç‰‡æ®µ${index + 1}å­—å¹•: ${text.substring(0, 30)}...`);\n  });\n\n  // å¦‚æœæ²¡æœ‰å­—å¹•ï¼Œè¿”å›null\n  if (subtitleFilters.length === 0) {\n    return null;\n  }\n\n  // æ„å»ºæ»¤é•œé“¾ï¼š[0:v]drawtext1,drawtext2,drawtext3[v]\n  const filterComplex = `[0:v]${subtitleFilters.join(',')}[v]`;\n\n  return filterComplex;\n}\n\n// ç®€åŒ–çš„è´¨é‡æ£€æŸ¥ - åªè®°å½•ä¿¡æ¯ï¼Œä¸æŠ¥é”™\nfunction analyzeSubtitles(segments) {\n  let validSegments = 0;\n  const analysis = {\n    totalSegments: segments.length,\n    validSegments: 0,\n    shortSegments: 0,\n    longSegments: 0,\n    averageDuration: 0,\n    totalDuration: 0\n  };\n\n  segments.forEach((segment, index) => {\n    if (!segment.text || segment.text.trim() === '') {\n      return;\n    }\n\n    validSegments++;\n\n    const duration = segment.endTime - segment.startTime;\n    analysis.totalDuration += duration;\n\n    // è®°å½•æ—¶é•¿åˆ†å¸ƒï¼ˆä¸æŠ¥é”™ï¼‰\n    if (duration < 1.5) {\n      analysis.shortSegments++;\n      console.log(`ç‰‡æ®µ${index + 1}æ˜¾ç¤ºæ—¶é—´è¾ƒçŸ­: ${duration.toFixed(1)}ç§’`);\n    } else if (duration > 15) {\n      analysis.longSegments++;\n      console.log(`ç‰‡æ®µ${index + 1}æ˜¾ç¤ºæ—¶é—´è¾ƒé•¿: ${duration.toFixed(1)}ç§’`);\n    }\n  });\n\n  analysis.validSegments = validSegments;\n  analysis.averageDuration = validSegments > 0 ? analysis.totalDuration / validSegments : 0;\n\n  return analysis;\n}\n\n// ç”Ÿæˆæœ€ç»ˆé…ç½® - ä¼˜åŒ–ç‰ˆæœ¬\ntry {\n  console.log('æ‰€æœ‰è¾“å…¥é¡¹æ•°é‡:', allInputs.length);\n  console.log('å­—å¹•ç‰‡æ®µæ•°é‡:', subtitleSegments.length);\n\n  // å‹å¥½çš„æ•°æ®éªŒè¯\n  if (!Array.isArray(subtitleSegments)) {\n    console.warn('å­—å¹•æ•°æ®ä¸æ˜¯æ•°ç»„æ ¼å¼ï¼Œå°è¯•è½¬æ¢...');\n    subtitleSegments = [subtitleSegments].filter(Boolean);\n  }\n\n  if (subtitleSegments.length === 0) {\n    console.warn('æ²¡æœ‰æ‰¾åˆ°å­—å¹•æ•°æ®ï¼Œè¿”å›ç©ºé…ç½®');\n    return [{\n      json: {\n        nca_config: {\n          id: `empty-subtitle-${Date.now()}`,\n          inputs: [{ file_url: videoUrl }],\n          filters: [],\n          outputs: [{\n            options: [\n              { option: \"-c:v\", argument: \"copy\" },\n              { option: \"-c:a\", argument: \"copy\" }\n            ]\n          }],\n          metadata: { duration: true, thumbnail: true }\n        },\n        message: 'æ²¡æœ‰å­—å¹•æ•°æ®ï¼Œè¿”å›åŸå§‹è§†é¢‘',\n        analysis: { totalSegments: 0, validSegments: 0 }\n      }\n    }];\n  }\n\n  if (!videoUrl) {\n    console.warn('è§†é¢‘URLä¸ºç©ºï¼Œä½¿ç”¨é»˜è®¤å€¼');\n    videoUrl = 'https://example.com/default-video.mp4';\n  }\n\n  // ç”Ÿæˆæ»¤é•œé“¾\n  const filterComplex = generateSubtitleFilter(subtitleSegments);\n\n  // åˆ†æå­—å¹•ï¼ˆä¸æŠ¥é”™ï¼‰\n  const analysis = analyzeSubtitles(subtitleSegments);\n\n  // å¦‚æœæ²¡æœ‰æœ‰æ•ˆå­—å¹•ï¼Œè¿”å›åŸå§‹è§†é¢‘é…ç½®\n  if (!filterComplex) {\n    console.log('æ²¡æœ‰ç”Ÿæˆæœ‰æ•ˆå­—å¹•æ»¤é•œï¼Œè¿”å›åŸå§‹è§†é¢‘é…ç½®');\n    return [{\n      json: {\n        nca_config: {\n          id: `no-subtitle-${Date.now()}`,\n          inputs: [{ file_url: videoUrl }],\n          filters: [],\n          outputs: [{\n            options: [\n              { option: \"-c:v\", argument: \"copy\" },\n              { option: \"-c:a\", argument: \"copy\" }\n            ]\n          }],\n          metadata: { duration: true, thumbnail: true }\n        },\n        message: 'æ²¡æœ‰æœ‰æ•ˆå­—å¹•ï¼Œè¿”å›åŸå§‹è§†é¢‘',\n        analysis: analysis\n      }\n    }];\n  }\n\n  // ç”ŸæˆNCAè¯·æ±‚é…ç½®\n  const ncaConfig = {\n    id: `intelligent-subtitle-${Date.now()}`,\n    inputs: [\n      {\n        file_url: videoUrl\n      }\n    ],\n    filters: [\n      {\n        filter: filterComplex\n      }\n    ],\n    outputs: [\n      {\n        options: [\n          {\n            option: \"-map\",\n            argument: \"[v]\"\n          },\n          {\n            option: \"-map\",\n            argument: \"0:a?\" // ä½¿ç”¨å¯é€‰éŸ³é¢‘æ˜ å°„ï¼Œé˜²æ­¢æ— éŸ³é¢‘æµæŠ¥é”™\n          },\n          {\n            option: \"-c:v\",\n            argument: \"libx264\"\n          },\n          {\n            option: \"-c:a\",\n            argument: \"copy\"\n          },\n          {\n            option: \"-preset\",\n            argument: \"medium\"\n          },\n          {\n            option: \"-crf\",\n            argument: \"23\"\n          }\n        ]\n      }\n    ],\n    metadata: {\n      duration: true,\n      thumbnail: true\n    }\n  };\n\n  // è¿”å›ç»“æœ\n  return [{\n    json: {\n      nca_config: ncaConfig,\n      analysis: analysis,\n      filter_complex: filterComplex,\n      processing_summary: {\n        total_segments: analysis.totalSegments,\n        valid_segments: analysis.validSegments,\n        short_segments: analysis.shortSegments,\n        long_segments: analysis.longSegments,\n        average_duration: analysis.averageDuration.toFixed(2),\n        estimated_duration: Math.max(...subtitleSegments.map(s => s.endTime || 0))\n      },\n      message: 'å­—å¹•é…ç½®ç”ŸæˆæˆåŠŸ'\n    }\n  }];\n\n} catch (error) {\n  console.error('å­—å¹•å¤„ç†è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯:', error);\n\n  // è¿”å›å®‰å…¨çš„é»˜è®¤é…ç½®\n  return [{\n    json: {\n      nca_config: {\n        id: `error-fallback-${Date.now()}`,\n        inputs: [{ file_url: videoUrl || 'https://example.com/fallback-video.mp4' }],\n        filters: [],\n        outputs: [{\n          options: [\n            { option: \"-c:v\", argument: \"copy\" },\n            { option: \"-c:a\", argument: \"copy\" }\n          ]\n        }],\n        metadata: { duration: true, thumbnail: true }\n      },\n      message: 'å­—å¹•å¤„ç†å¤±è´¥ï¼Œè¿”å›åŸå§‹è§†é¢‘é…ç½®',\n      error: error.message,\n      fallback: true\n    }\n  }];\n}\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        432,
        2928
      ],
      "id": "c4e82b0a-e47d-4ffe-9998-3c25ed99deb6",
      "name": "Code1"
    },
    {
      "parameters": {
        "command": "=ffmpeg -y \\\n  -i \"{{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/C-00{{ $json.scene_id }}.mp4\" \\\n  -filter_complex \"{{ $json.nca_config.filters[0].filter }}\" \\\n  -map \"[v]\" -map 0:a? -c:v libx264 -c:a copy -preset medium -crf 23 \\\n  \"{{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/video/00{{ $json.scene_id }}.mp4\"\n"
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        880,
        2848
      ],
      "id": "323761c1-1aa8-4d67-bc49-0f9edc241d2c",
      "name": "Execute Command"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "254af635-f2c8-4eb0-96d9-4d068c1cc031",
              "leftValue": "={{ $json.candidates[0].content.parts[0].text }}",
              "rightValue": "={{ $json.candidates[0].content.parts[0].text }}",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -240,
        2896
      ],
      "id": "c8dfbd80-5313-4784-a992-fae9a61128fb",
      "name": "If1"
    },
    {
      "parameters": {
        "command": "=ffmpeg -y -i \"{{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/b-{{ $('Code in JavaScript').item.json.targetVideoFilename }}\" -i \"{{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/{{ $('Code in JavaScript').item.json.bestMatchFilename }}\" -c:v copy -c:a aac -map 0:v:0 -map 1:a:0 \"{{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/C-00{{ $('Loop Over Items').item.json.scene_id }}.mp4\""
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        -1360,
        2976
      ],
      "id": "fd9d56bb-6816-44c3-94f1-341e1420c4dd",
      "name": "Execute Command3"
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -16,
        3072
      ],
      "id": "be5d882c-9721-41e8-b65e-3e1d3c74af23",
      "name": "Wait",
      "webhookId": "95390f97-3215-4bd5-bae9-3913ce524f22"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        656,
        2848
      ],
      "id": "d3f797ea-bc35-40bf-a100-2ab99fe75f12",
      "name": "Merge"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "options": {
          "includeUnpaired": true
        }
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -1984,
        1056
      ],
      "id": "e2f46e98-62df-4d54-af0c-6d5638e7761a",
      "name": "Merge1"
    },
    {
      "parameters": {
        "fileSelector": "./input/TimbreModel/æ’­éŸ³ä¸­å¹´ç”·.mp3",
        "options": {}
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        -1616,
        2128
      ],
      "id": "929b0e1b-f170-4e20-8e92-34b7cec37825",
      "name": "Read/Write Files from Disk5"
    },
    {
      "parameters": {
        "url": "={{ $json[\"216\"] }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -48,
        1808
      ],
      "id": "6217c53e-f2e6-454f-9b73-fb31a90d19b7",
      "name": "HTTP Request18"
    },
    {
      "parameters": {
        "url": "={{ $json[\"217\"] }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -48,
        2000
      ],
      "id": "637884b2-0bba-4136-8c80-c77c0ae8d3c0",
      "name": "HTTP Request19"
    },
    {
      "parameters": {
        "url": "={{ $json[\"218\"] }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -48,
        2192
      ],
      "id": "d6420c4d-4032-4619-b58b-1bb1f7b1212c",
      "name": "HTTP Request20"
    },
    {
      "parameters": {
        "operation": "write",
        "fileName": "={{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/00{{ $('Loop Over Items').item.json.scene_id }}_v1.flac",
        "options": {}
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        176,
        1808
      ],
      "id": "62967703-69ef-4584-840b-381786613935",
      "name": "Read/Write Files from Disk4"
    },
    {
      "parameters": {
        "inputPath": "={{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/00{{ $('Loop Over Items').item.json.scene_id }}_v1.flac"
      },
      "type": "n8n-nodes-klib-ffmpeg.ffprobe",
      "typeVersion": 1,
      "position": [
        400,
        1808
      ],
      "id": "e273c561-9a23-4143-9739-ee11b1145529",
      "name": "FFprobe5"
    },
    {
      "parameters": {
        "operation": "write",
        "fileName": "={{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/00{{ $('Loop Over Items').item.json.scene_id }}_v2.flac",
        "options": {}
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        176,
        2000
      ],
      "id": "34882f6e-52aa-45d5-b70b-7e68b0f0c750",
      "name": "Read/Write Files from Disk7"
    },
    {
      "parameters": {
        "inputPath": "={{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/00{{ $('Loop Over Items').item.json.scene_id }}_v2.flac"
      },
      "type": "n8n-nodes-klib-ffmpeg.ffprobe",
      "typeVersion": 1,
      "position": [
        400,
        2000
      ],
      "id": "8eb5b83d-de3c-4c87-8677-f051e57126fb",
      "name": "FFprobe6"
    },
    {
      "parameters": {
        "operation": "write",
        "fileName": "={{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/00{{ $('Loop Over Items').item.json.scene_id }}_v3.flac",
        "options": {}
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        176,
        2192
      ],
      "id": "c7190499-5049-454f-8e3c-261cb4b38f57",
      "name": "Read/Write Files from Disk8"
    },
    {
      "parameters": {
        "inputPath": "={{ './output/' + new Date().toISOString().slice(0, 10) }}/{{ $('Code').item.json.video_title_chinese }}/00{{ $('Loop Over Items').item.json.scene_id }}_v3.flac"
      },
      "type": "n8n-nodes-klib-ffmpeg.ffprobe",
      "typeVersion": 1,
      "position": [
        400,
        2192
      ],
      "id": "a2c252cc-035d-43cd-9999-3975136f8b4e",
      "name": "FFprobe7"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "e472e990-9508-46f8-a198-bee25c223669",
              "leftValue": "={{ $json.data }}",
              "rightValue": "SUCCESS",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -720,
        2048
      ],
      "id": "c5a0ab4b-eedd-47e7-af2e-d618d327df75",
      "name": "If"
    },
    {
      "parameters": {
        "jsCode": "const output = []; // å£°æ˜ä¸€ä¸ªæ•°ç»„æ¥å­˜å‚¨ Code èŠ‚ç‚¹çš„è¾“å‡º Item\nconst targetNodeIds = [\"216\", \"217\", \"218\"]; // å®šä¹‰æˆ‘ä»¬è¦æŸ¥æ‰¾çš„ç›®æ ‡ nodeId åˆ—è¡¨\nconst extractedUrlsMap = {}; // ç”¨äºå­˜å‚¨æå–åˆ°çš„ URLï¼Œä»¥ nodeId ä¸ºé”®\n\n// N8N çš„ Code èŠ‚ç‚¹é€šå¸¸ä¼šæ¥æ”¶ä¸€ä¸ªæˆ–å¤šä¸ª Itemã€‚\n// åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œæ‚¨çš„ JSON ç»“æ„è¢«åŒ…å«åœ¨ç¬¬ä¸€ä¸ª Item çš„ '.json' å±æ€§ä¸­ã€‚\n// '$input.item' å¯ä»¥ç”¨æ¥è®¿é—®å½“å‰ Itemï¼ˆå¦‚æœåªæœ‰ä¸€ä¸ªè¾“å…¥ Itemï¼Œæˆ–è€…åœ¨å¾ªç¯ä¸­ï¼‰ã€‚\n// æˆ–è€…ä½¿ç”¨ $input.all()[0] æ¥è®¿é—®ç¬¬ä¸€ä¸ªè¾“å…¥ Itemã€‚\nconst inputItemJson = $input.item.json; // è·å–å½“å‰è¾“å…¥ Item çš„ JSON æ•°æ®\n\n// å‡è®¾JSONç»“æ„å¦‚ \"{ \"1\": { \"code\": 0, \"msg\": \"success\", \"data\": [...] } }\"\n// æˆ‘ä»¬éœ€è¦è®¿é—® \"1\" é”®ä¸‹çš„æ•°æ®\nconst responseContainer = inputItemJson;\n\n// æ£€æŸ¥ responseContainer æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”å®ƒåŒ…å«ä¸€ä¸ªåä¸º 'data' çš„æ•°ç»„\nif (responseContainer && responseContainer.data && Array.isArray(responseContainer.data)) {\n  // éå† 'data' æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå¯¹è±¡\n  for (const dataEntry of responseContainer.data) {\n    // ç¡®ä¿ nodeId æ˜¯å­—ç¬¦ä¸²ç±»å‹ä»¥ä¾¿è¿›è¡Œæ¯”è¾ƒ\n    const nodeId = String(dataEntry.nodeId);\n    // æ£€æŸ¥å½“å‰ dataEntry çš„ nodeId æ˜¯å¦åœ¨æˆ‘ä»¬çš„ç›®æ ‡åˆ—è¡¨ä¸­\n    if (targetNodeIds.includes(nodeId)) {\n      // å°†æ‰¾åˆ°çš„ URL å­˜å‚¨åˆ°æ˜ å°„ä¸­\n      extractedUrlsMap[nodeId] = dataEntry.fileUrl;\n    }\n  }\n}\n\n// æ„å»ºæœ€ç»ˆçš„è¾“å‡º JSON å¯¹è±¡\n// ç¡®ä¿å³ä½¿æŸäº› nodeId æ²¡æœ‰æ‰¾åˆ°ï¼Œå®ƒä»¬ä¹Ÿä¼šä½œä¸ºé”®å­˜åœ¨ï¼Œå€¼ä¸º null\nconst resultJson = {};\nfor (const nodeId of targetNodeIds) {\n  resultJson[nodeId] = extractedUrlsMap[nodeId] || null; // å¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™è®¾ç½®ä¸º null\n}\n\n// å°†åŒ…å«æå–åˆ°çš„ URL çš„ JSON å¯¹è±¡å°è£…æˆä¸€ä¸ª N8N Item\noutput.push({\n  json: resultJson\n});\n\nreturn output; // è¿”å› Code èŠ‚ç‚¹å¤„ç†åçš„ Item æ•°ç»„\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -272,
        2000
      ],
      "id": "2af830d9-0afb-4e49-b3b8-f1f94f90c3db",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -496,
        2224
      ],
      "id": "c7150eb1-fdd0-45c6-956e-c7a14aced2c5",
      "name": "Wait3",
      "webhookId": "aa6b0af1-402b-4e52-9185-c35aca18a9d4"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "5285d17d-ecff-4437-a064-c79ae4da356d",
              "name": "data.streams[0].duration",
              "value": "={{ $json.data.streams[0].duration }}",
              "type": "string"
            },
            {
              "id": "a8a1501f-4a23-4041-9b5a-bf0e8c3b57e9",
              "name": "inputPath",
              "value": "={{ $json.inputPath }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        624,
        1632
      ],
      "id": "003d474e-8350-4a74-9fc6-4925990d27b2",
      "name": "è·å–è§†é¢‘æ—¶é•¿"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "5285d17d-ecff-4437-a064-c79ae4da356d",
              "name": "data.streams[0].duration",
              "value": "={{ $json.data.streams[0].duration }}",
              "type": "string"
            },
            {
              "id": "47bbf741-c9f6-46f8-95c0-c3737806f8d0",
              "name": "inputPath",
              "value": "={{ $json.inputPath }}",
              "type": "string"
            },
            {
              "id": "9e48c693-3b35-49d9-b42a-ef76da128329",
              "name": "'æ—ç™½'].narration_v",
              "value": "={{ $('è®¾ç½®å‚æ•°-æ—ç™½-éŸ³ç”»åŒæ­¥1').item.json['æ—ç™½'].narration_v1 }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        624,
        1808
      ],
      "id": "73a44229-d782-4021-9828-1cf0a28f59d2",
      "name": "å£°éŸ³æ—¶é•¿-1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "7bb001af-7887-451a-b36f-117f79507f02",
              "name": "data.streams[0].duration",
              "value": "={{ $json.data.streams[0].duration }}",
              "type": "string"
            },
            {
              "id": "8c47e0ce-2e63-4bea-ae8b-8b288c50bf19",
              "name": "inputPath",
              "value": "={{ $json.inputPath }}",
              "type": "string"
            },
            {
              "id": "cd4acdbb-7591-434d-9929-37fdd00f1ba2",
              "name": "'æ—ç™½'].narration_v",
              "value": "={{ $('è®¾ç½®å‚æ•°-æ—ç™½-éŸ³ç”»åŒæ­¥1').item.json['æ—ç™½'].narration_v2 }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        624,
        2000
      ],
      "id": "3d718973-a6b5-45ce-ac84-144b299dce8f",
      "name": "å£°éŸ³æ—¶é•¿-2"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "3477bf69-b24a-45ba-a661-73462ad899d2",
              "name": "data.streams[0].duration",
              "value": "={{ $json.data.streams[0].duration }}",
              "type": "string"
            },
            {
              "id": "4be19b45-600d-489b-9c7f-b90be6e90b54",
              "name": "inputPath",
              "value": "={{ $json.inputPath }}",
              "type": "string"
            },
            {
              "id": "07669514-7b8e-41d4-95bb-35f7bf70646e",
              "name": "'æ—ç™½'].narration_v",
              "value": "={{ $('è®¾ç½®å‚æ•°-æ—ç™½-éŸ³ç”»åŒæ­¥1').item.json['æ—ç™½'].narration_v3 }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        624,
        2192
      ],
      "id": "2b8a0671-b829-4953-b981-c2c5e83593c3",
      "name": "å£°éŸ³æ—¶é•¿-3"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "afc34e60-c571-4a52-b7f3-ab343c2d0181",
              "name": "Theme",
              "value": "={{ $json[\"ä¸»é¢˜\"] }}",
              "type": "string"
            },
            {
              "id": "d9009c42-c083-418a-a3dd-df3baae3c01c",
              "name": "Prompt",
              "value": "={{ $json.Prompt }}",
              "type": "string"
            },
            {
              "id": "e0a449eb-6b76-4ee9-b49b-be5ea9f77424",
              "name": "comfyui-url",
              "value": "http://host.docker.internal:8188/",
              "type": "string"
            },
            {
              "id": "f56bfdad-81e0-4b6b-be2a-f1b2e87eeaf7",
              "name": "é£æ ¼",
              "value": "={{ $json[\"é£æ ¼\"] }}",
              "type": "string"
            },
            {
              "id": "7f935350-f81b-42a1-bdc6-32c7e03cd846",
              "name": "åœºæ™¯æ•°é‡",
              "value": "={{ $json['åœºæ™¯æ•°é‡'] }}",
              "type": "string"
            },
            {
              "id": "2da7caa1-42f2-4ea4-8916-07d596692f55",
              "name": "åˆ†é•œæ—¶é•¿",
              "value": "={{ $json['åˆ†é•œæ—¶é•¿'] }}",
              "type": "string"
            },
            {
              "id": "084a3486-dfc8-49fe-97fa-9e42a4813b69",
              "name": "è§†é¢‘å­—å¹•æç¤ºè¯",
              "value": " # è§†é¢‘å†…å®¹ä¸å­—å¹•åŒæ­¥ä¸“å®¶ (éŸ³é¢‘è½¬å½•èšç„¦ç‰ˆ - ç»“æ„ä½“ä¼˜åŒ–)  ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„è§†é¢‘å†…å®¹åˆ†æå¸ˆå’Œå­—å¹•åŒæ­¥ä¸“å®¶ã€‚ä½ çš„æ ¸å¿ƒä»»åŠ¡æ˜¯**æ·±åº¦åˆ†æè§†é¢‘ä¸­çš„è§†è§‰ä¿¡æ¯å’Œæ¨æ–­çš„å£è¯­è¯­éŸ³ä¿¡æ¯**ï¼Œå¹¶ä¸ºè§†é¢‘çš„æ¯ä¸€ä¸ªéœ€è¦å­—å¹•çš„ç”»é¢æ®µç”Ÿæˆé«˜åº¦ç²¾ç¡®ã€æ— ç¼åŒ¹é…çš„**å£è¯­å­—å¹•æ¡ç›®**ã€‚ä½ ä¸ä»…è¦è¯†åˆ«ç”»é¢å˜åŒ–ï¼Œæ›´è¦å…³æ³¨**æ¯ä¸€ä¸ªå¯èƒ½åŒ…å«å£è¯­å¯¹è¯æˆ–æ—ç™½çš„æ—¶åˆ»**ï¼Œç¡®ä¿ç”Ÿæˆçš„å­—å¹•ï¼ˆä»…é™å£è¯­å†…å®¹ï¼‰çš„å‡ºç°å’Œæ¶ˆå¤±éƒ½ä¸ç”»é¢çš„å£å‹ã€ä¸Šä¸‹æ–‡**å®Œç¾åŒæ­¥**ï¼Œä¸”åœ¨è§†è§‰ä¸Š**ä¸é€ æˆä»»ä½•é®æŒ¡æˆ–å†²çª**ã€‚  **ç‰¹åˆ«å¼ºè°ƒï¼šå¯¹äºè¾ƒé•¿çš„å£è¯­è¯­éŸ³ï¼Œä½ å¿…é¡»è¿›è¡Œæ™ºèƒ½æ‹†åˆ†ï¼Œç¡®ä¿æ¯ä¸ªå­—å¹•æ¡ç›®åœ¨è§†è§‰ä¸Šä¸è¿‡é•¿ï¼Œæ˜“äºé˜…è¯»ï¼Œä¸”ä¸æº¢å‡ºå½“å‰ç”»é¢ã€‚è¿™å°†æ¶‰åŠå¯¹åŸè§†é¢‘éŸ³é¢‘çš„ä»”ç»†åˆ†æã€‚**  ## åˆ†æä¸å­—å¹•ç”Ÿæˆè¦æ±‚ï¼š 1.  **è¶…ç²¾ç»†æ—¶é—´æˆ³ï¼ˆæ›´ç²¾ç¡®ã€æ›´ç»†è‡´ï¼‰ï¼š** è¯†åˆ«å¹¶è®°å½•æ¯ä¸ªå­—å¹•æ®µçš„å¼€å§‹å’Œç»“æŸæ—¶é—´ï¼Œ**ç²¾ç¡®åˆ°0.01ç§’ç”šè‡³0.001ç§’**ï¼ˆå¦‚å¯èƒ½ï¼‰ã€‚è¿™æ˜¯å£è¯­å­—å¹•ä¸ç”»é¢å®Œç¾åŒæ­¥ä»¥åŠ**æ™ºèƒ½æ‹†åˆ†åå„ç‰‡æ®µç²¾ç¡®è¡”æ¥**çš„æ ¸å¿ƒã€‚æ—¶é—´æˆ³åº”**ä¸è¯­éŸ³çš„å®é™…èµ·æ­¢ç‚¹ç²¾ç¡®å¯¹åº”**ï¼Œè€Œéä»…ä»…åŸºäºç”»é¢åˆ‡æ¢ã€‚ 2.  **ç”»é¢å†…å®¹åˆ†æï¼š**     *   è¯†åˆ«æ‰€æœ‰**ä¸»è¦çš„ç”»é¢åˆ‡æ¢ç‚¹**ï¼ˆåœºæ™¯å˜åŒ–ã€é•œå¤´åˆ‡æ¢ã€é‡è¦è½¬åœºï¼‰ã€‚     *   è®°å½•æ¯ä¸ªç”»é¢æ®µçš„**æ ¸å¿ƒè§†è§‰å†…å®¹**ï¼ˆäººç‰©åŠ¨ä½œã€ç‰©ä½“ç‰¹å†™ã€ç”»é¢ç„¦ç‚¹ã€èƒŒæ™¯ä¿¡æ¯ç­‰ï¼‰ã€‚     *   **è¯†åˆ«å¹¶ç‹¬ç«‹è®°å½•ç”»é¢ä¸­ä»»ä½•é‡è¦çš„æ–‡å­—ä¿¡æ¯**ï¼ˆå¦‚ç‰‡å¤´æ ‡é¢˜ã€Logoã€ä¸»æŒäººå§“åæ¡ã€äº§å“åŠŸèƒ½ä»‹ç»ã€å›¾è¡¨æ–‡å­—ç­‰ï¼‰ï¼Œè¿™äº›ä¿¡æ¯å°†æ”¾å…¥`on_screen_text_content`å­—æ®µã€‚     *   åˆ†æç”»é¢ä¸­çš„**è¿åŠ¨ã€é®æŒ¡åŒºåŸŸ**ï¼ˆå¦‚å¿«é€Ÿç§»åŠ¨çš„ç‰©ä½“ã€å±å¹•ä¸Šæ–¹çš„æ°´å°/Logoã€åº•éƒ¨çš„è¿›åº¦æ¡ç­‰ï¼‰ï¼Œä»¥æŒ‡å¯¼å­—å¹•æ”¾ç½®ã€‚ 3.  **å­—å¹•æ–‡æœ¬ç”Ÿæˆï¼ˆæ ¸å¿ƒä¸æ‹†åˆ†ç­–ç•¥ï¼‰ï¼š**     *   **`text`å­—æ®µä¸¥æ ¼é™å®šä¸ºï¼š** æ ¹æ®ç”»é¢å†…å®¹ã€äººç‰©å£å‹ï¼ˆå¦‚å¯è¾¨è¯†ï¼‰ã€æƒ…å¢ƒä¸Šä¸‹æ–‡ï¼Œä»¥åŠ**æœ€é‡è¦çš„æ˜¯å¯¹åŸè§†é¢‘éŸ³é¢‘çš„ç²¾ç»†åˆ†æ**ï¼Œæ¨æ–­å¹¶ç”Ÿæˆç”»é¢ä¸­æ‰€æœ‰éœ€è¦åŒ¹é…çš„å£è¯­è¯­éŸ³è½¬å½•ã€‚     *   å­—å¹•æ–‡æœ¬åº”**ç®€æ´ã€å‡†ç¡®ã€ç¬¦åˆè¯­å¢ƒ**ï¼Œä¸”**åªåŒ…å«å£è¯­å†…å®¹**ï¼Œä¸åŒ…å«å±å¹•æ–‡å­—æˆ–éè¯­éŸ³éŸ³æ•ˆæè¿°ã€‚     *   **æ™ºèƒ½æ‹†åˆ†é•¿å¥ï¼š**         *   é’ˆå¯¹è¾ƒé•¿çš„å£è¯­è¯­éŸ³ï¼Œä½ å¿…é¡»è¿›è¡Œ**æ™ºèƒ½æ‹†åˆ†**ï¼Œç¡®ä¿æ¯ä¸ªå­—å¹•æ¡ç›®åœ¨è§†è§‰ä¸Š**ä¸è¿‡é•¿ï¼Œæ˜“äºé˜…è¯»ï¼Œä¸”ä¸é€ æˆç”»é¢æº¢å‡º**ã€‚         *   æ‹†åˆ†æ—¶ï¼Œéœ€ä¼˜å…ˆè€ƒè™‘**è¯­è¨€çš„è‡ªç„¶åœé¡¿ã€è¯­æ³•ç»“æ„ï¼ˆå¦‚é€—å·ã€å¥å·ã€è¿è¯ï¼‰ã€å£å‹å˜åŒ–ã€ä»¥åŠç”»é¢åˆ‡æ¢**ï¼Œé¿å…åˆ‡æ–­æ ¸å¿ƒè¯­ä¹‰ã€‚         *   æ¯ä¸ªæ‹†åˆ†åçš„å­—å¹•æ®µåº”**ä¿æŒä¸Šä¸‹æ–‡è¿è´¯ï¼Œå¹¶å…·æœ‰ç‹¬ç«‹çš„é˜…è¯»æ„ä¹‰**ã€‚ä¸€ä¸ªå®Œæ•´çš„å¥å­å¯èƒ½ä¼šè¢«æ‹†åˆ†ä¸ºå¤šä¸ª`scenes`æ¡ç›®ï¼Œæ¯ä¸ªæ¡ç›®å¯¹åº”å¥å­çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶æœ‰è‡ªå·±ç²¾ç¡®çš„`startTime`å’Œ`endTime`ã€‚         *   é¿å…ç”Ÿæˆè¿‡çŸ­çš„ã€ç ´ç¢çš„å­—å¹•ç‰‡æ®µï¼ˆå¦‚å•ä¸ªä»‹è¯æˆ–å† è¯ï¼‰ï¼Œé™¤éåœ¨æç‰¹æ®Šçš„è¯­å¢ƒä¸‹å¿…è¦ã€‚ 4.  **å­—å¹•æ˜¾ç¤ºç­–ç•¥ï¼š**     *   æ ¹æ®ç”»é¢å†…å®¹çš„**è§†è§‰ç‰¹å¾ã€ç”»é¢å¤æ‚åº¦ã€å·²æœ‰æ–‡å­—ä¿¡æ¯ï¼ˆåŒ…æ‹¬`on_screen_text_content`ï¼‰å’ŒåŠ¨æ€å…ƒç´ **ï¼Œæ™ºèƒ½æ¨èæœ€é€‚åˆæ˜¾ç¤º**å£è¯­å­—å¹•**çš„åŒºåŸŸå’Œæ ·å¼ã€‚     *   **ä¼˜å…ˆé¿å…é®æŒ¡**ç”»é¢ä¸­çš„å…³é”®ä¿¡æ¯ï¼ˆå¦‚äººè„¸ã€äº§å“ç»†èŠ‚ã€**ç”»é¢ä¸­å·²æœ‰çš„æ–‡å­—**ï¼‰ã€‚     *   è€ƒè™‘å­—å¹•ä¸ç”»é¢åˆ‡æ¢çš„**è‡ªç„¶è¡”æ¥**ï¼Œé¿å…çªå…€çš„å‡ºç°æˆ–æ¶ˆå¤±ã€‚  ## è¾“å‡ºæ ¼å¼ï¼ˆä¸¥æ ¼JSONå¯¹è±¡ï¼‰ï¼š ```json {   \"scenes\": [     {       \"id\": 1, // ç”¨äºå”¯ä¸€æ ‡è¯†æ¯ä¸ªå­—å¹•æ¡ç›®       \"startTime\": 0.00, // ç²¾ç¡®åˆ°0.01æˆ–0.001ç§’       \"endTime\": 2.55,   // ç²¾ç¡®åˆ°0.01æˆ–0.001ç§’       \"text\": \"æ¬¢è¿æ¥åˆ°æˆ‘ä»¬çš„æ–°å“å‘å¸ƒä¼šï¼Œ\", // æ™ºèƒ½æ‹†åˆ†åçš„ç¬¬ä¸€éƒ¨åˆ†       \"visual_context\": \"å¼€åœºï¼Œä¸»æŒäººæ­£é¢ç‰¹å†™ï¼Œå¾®ç¬‘ï¼Œçœ¼ç¥ä¸è§‚ä¼—äº’åŠ¨ã€‚èƒŒæ™¯éŸ³ä¹è½»å¿«ã€‚\", // å¯¹å½“å‰å­—å¹•å¯¹åº”ç”»é¢çš„è¯¦ç»†è§†è§‰å’Œéè¯­éŸ³å¬è§‰æè¿°       \"scene_type\": \"intro_speech\", // intro/demo/explanation/conclusion/transition/on_screen_text ç­‰       \"subtitle_zone_suggestion\": \"bottom_center\", // top/center/bottom/top_left/bottom_rightç­‰ï¼Œæ¨èå­—å¹•ä½ç½®       \"visual_complexity\": \"low\", // low/medium/highï¼Œç”»é¢å…ƒç´ å¤šå°‘å’ŒåŠ¨æ€ç¨‹åº¦       \"on_screen_obstacles\": \"ç”»é¢ä¸‹æ–¹æ— æ˜æ˜¾é®æŒ¡ï¼Œå·¦ä¸Šè§’æœ‰èŠ‚ç›®Logoï¼Œä¸å½±å“å­—å¹•åŒºåŸŸã€‚\", // æè¿°ç”»é¢ä¸­å·²æœ‰çš„ã€å¯èƒ½ä¸å­—å¹•åŒºåŸŸå†²çªçš„è§†è§‰å…ƒç´ æˆ–åŠ¨æ€ï¼ŒæŒ‡å¯¼å­—å¹•é¿å¼€       \"on_screen_text_content\": \"\", // ç”»é¢ä¸­æ˜¾ç¤ºçš„ä»»ä½•é‡è¦æ–‡å­—å†…å®¹ï¼Œå¦‚æ ‡é¢˜ã€Logoæ–‡å­—ç­‰ï¼Œå¦‚æœå­˜åœ¨       \"is_inferred_speech\": false // å¦‚æœå­—å¹•æ˜¯æ ¹æ®å£å‹/ä¸Šä¸‹æ–‡æ¨æ–­çš„è¯­éŸ³ï¼Œè®¾ä¸ºtrueã€‚è‹¥æœ‰å®é™…éŸ³é¢‘ï¼Œåˆ™ä¸ºfalseã€‚     },     {       \"id\": 2,       \"startTime\": 2.60,       \"endTime\": 4.10,       \"text\": \"ä»Šå¤©æˆ‘ä»¬å³å°†æ­æ™“ä¸€æ¬¾\", // æ™ºèƒ½æ‹†åˆ†åçš„ç¬¬äºŒéƒ¨åˆ†ï¼Œæ—¶é—´æˆ³ä¸è¯­éŸ³åœé¡¿ç²¾ç¡®åŒ¹é…       \"visual_context\": \"ä¸»æŒäººè¡¨æƒ…è½¬ä¸ºæœŸå¾…ï¼Œæ‰‹åŠ¿ç•¥å¾®æŠ¬èµ·ï¼Œå‡†å¤‡ä»‹ç»äº§å“ã€‚\",       \"scene_type\": \"intro_speech\",       \"subtitle_zone_suggestion\": \"bottom_center\",       \"visual_complexity\": \"low\",       \"on_screen_obstacles\": \"æ— æ˜æ˜¾é®æŒ¡ã€‚\",       \"on_screen_text_content\": \"\",       \"is_inferred_speech\": false     },     {       \"id\": 3,       \"startTime\": 4.15,       \"endTime\": 5.90,       \"text\": \"é¢ è¦†æ€§çš„åˆ›æ–°äº§å“ã€‚\", // æ™ºèƒ½æ‹†åˆ†åçš„ç¬¬ä¸‰éƒ¨åˆ†       \"visual_context\": \"ä¸»æŒäººçœ¼ç¥åšå®šï¼Œè¯­æ°”å¼ºè°ƒã€‚èƒŒæ™¯éŸ³ä¹èŠ‚å¥æ„Ÿå¢å¼ºã€‚\",       \"scene_type\": \"intro_speech\",       \"subtitle_zone_suggestion\": \"bottom_center\",       \"visual_complexity\": \"low\",       \"on_screen_obstacles\": \"æ— æ˜æ˜¾é®æŒ¡ã€‚\",       \"on_screen_text_content\": \"\",       \"is_inferred_speech\": false     },     {       \"id\": 4,       \"startTime\": 6.00,       \"endTime\": 8.50,       \"text\": \"\", // å½“å‰ç”»é¢æ— å£è¯­è¯­éŸ³è½¬å½•       \"visual_context\": \"ç”»é¢åˆ‡æ¢åˆ°äº§å“å†…éƒ¨ç»“æ„ç‰¹å†™ï¼ŒåŠ¨æ€å±•ç¤ºèŠ¯ç‰‡ç»„ï¼Œå±å¹•ä¸­å¤®æµ®ç°æ–‡å­—ã€‚\",       \"scene_type\": \"product_feature_display\",       \"subtitle_zone_suggestion\": \"none\", // å»ºè®®ä¸æ˜¾ç¤ºå£è¯­å­—å¹•ï¼Œå› ä¸ºæ— è¯­éŸ³ï¼Œä¸”ç”»é¢å·²æœ‰å¤§é‡æ–‡å­—       \"visual_complexity\": \"medium\",       \"on_screen_obstacles\": \"ç”»é¢ä¸­å¤®æœ‰äº§å“æ ¸å¿ƒåŠŸèƒ½æ–‡å­—å±•ç¤ºï¼Œåº•éƒ¨æœ‰äº§å“å‹å·æ°´å°ã€‚\",       \"on_screen_text_content\": \"æ™ºèƒ½èŠ¯ç‰‡ æè‡´æ€§èƒ½\", // ç”»é¢ä¸­æ˜¾ç¤ºçš„æ–‡å­—å†…å®¹       \"is_inferred_speech\": false     },     {       \"id\": 5,       \"startTime\": 8.55,       \"endTime\": 11.20,       \"text\": \"\", // å½“å‰ç”»é¢æ— å£è¯­è¯­éŸ³è½¬å½•       \"visual_context\": \"äº§å“åœ¨æˆ·å¤–ç¯å¢ƒä¸­ä½¿ç”¨åœºæ™¯æ¼”ç¤ºï¼Œç”¨æˆ·é¢å¸¦ç¬‘å®¹æ“ä½œï¼Œç”»é¢æµç•…ã€‚èƒŒæ™¯éŸ³ä¹æ„‰æ‚¦ã€‚\",       \"scene_type\": \"product_demo_montage\",       \"subtitle_zone_suggestion\": \"none\", // æ— å£è¯­å­—å¹•ï¼Œå¯é€‰æ‹©ä¸æ˜¾ç¤º       \"visual_complexity\": \"high\",       \"on_screen_obstacles\": \"ç”»é¢æ•´ä½“åŠ¨æ€è¾ƒå¤šï¼Œä½†åº•éƒ¨åŒºåŸŸç›¸å¯¹ç¨³å®šï¼Œæ— é®æŒ¡ç‰©ã€‚\",       \"on_screen_text_content\": \"æ–°å“å‘å¸ƒ\", // å‡è®¾ç”»é¢ä¸Šæ–¹çŸ­æš‚å‡ºç°äº†ä¸€ä¸ªå°æ ‡é¢˜       \"is_inferred_speech\": false     },     {       \"id\": 6,       \"startTime\": 11.30,       \"endTime\": 13.50,       \"text\": \"æ­£å¦‚æ‚¨æ‰€è§ï¼Œè¿™æ¬¾äº§å“\", // æ™ºèƒ½æ‹†åˆ†åçš„ç¬¬ä¸€éƒ¨åˆ†       \"visual_context\": \"ä¸»æŒäººé‡æ–°å‡ºç°ï¼Œç‰¹å†™é•œå¤´ï¼Œå·¦æ‰‹æŒ‡å‘ç”»é¢å³ä¾§äº§å“æ¨¡å‹ï¼Œå£å‹åŒæ­¥ï¼Œè¯­æ°”å¼ºè°ƒã€‚\",       \"scene_type\": \"conclusion_speech\",       \"subtitle_zone_suggestion\": \"bottom_left\", // é¿å…é®æŒ¡ä¸»æŒäººæ‰‹åŠ¿å’Œäº§å“æ¨¡å‹       \"visual_complexity\": \"low\",       \"on_screen_obstacles\": \"ç”»é¢å³ä¾§æ˜¯äº§å“æ¨¡å‹ç‰¹å†™ï¼Œä¸»æŒäººæ‰‹åŠ¿æŒ‡å‘è¯¥åŒºåŸŸï¼Œå­—å¹•éœ€é¿å¼€ã€‚\",       \"on_screen_text_content\": \"\",       \"is_inferred_speech\": true // å‡è®¾æ­¤å¤„è¯­éŸ³æ˜¯æ ¹æ®å£å‹å’Œä¸Šä¸‹æ–‡æ¨æ–­     },     {       \"id\": 7,       \"startTime\": 13.55,       \"endTime\": 15.80,       \"text\": \"å¸¦æ¥äº†å‰æ‰€æœªæœ‰çš„ä½“éªŒã€‚\", // æ™ºèƒ½æ‹†åˆ†åçš„ç¬¬äºŒéƒ¨åˆ†       \"visual_context\": \"ä¸»æŒäººé¢å¸¦è‡ªä¿¡å¾®ç¬‘ï¼Œçœ‹å‘é•œå¤´ï¼Œæ‰‹åŠ¿æ”¶å›ã€‚\",       \"scene_type\": \"conclusion_speech\",       \"subtitle_zone_suggestion\": \"bottom_center\",       \"visual_complexity\": \"low\",       \"on_screen_obstacles\": \"æ— æ˜æ˜¾é®æŒ¡ã€‚\",       \"on_screen_text_content\": \"\",       \"is_inferred_speech\": true     }   ] } ```  ## å­—æ®µè¯´æ˜ (ä¸ä¹‹å‰ä¿æŒä¸€è‡´ï¼Œä»…ä¸ºå®Œæ•´æ€§å†æ¬¡åˆ—å‡º): -   `id`: æ¯ä¸ªå­—å¹•æ¡ç›®çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚ -   `startTime/endTime`: **å­—å¹•å¼€å§‹å’Œç»“æŸæ˜¾ç¤ºçš„æ—¶é—´ç‚¹**ï¼Œ**ç²¾ç¡®åˆ°0.01æˆ–0.001ç§’**ã€‚è¿™æ˜¯å£è¯­å­—å¹•ä¸ç”»é¢åŒæ­¥çš„æ ¸å¿ƒï¼Œç‰¹åˆ«æ˜¯å¯¹äº**æ™ºèƒ½æ‹†åˆ†åçš„æ¯ä¸ªç‰‡æ®µ**ï¼ŒåŠ¡å¿…ä¸å¯¹åº”è¯­éŸ³çš„å®é™…èµ·æ­¢ç‚¹ç²¾ç¡®åŒ¹é…ã€‚ -   `text`: **è¦æ˜¾ç¤ºçš„å£è¯­è¯­éŸ³è½¬å½•å†…å®¹ã€‚** å¯¹äºè¾ƒé•¿çš„å£è¯­å†…å®¹ï¼Œæ­¤å­—æ®µå°†åŒ…å«å…¶**æ™ºèƒ½æ‹†åˆ†åçš„ä¸€éƒ¨åˆ†**ã€‚**ä¸¥æ ¼åªåŒ…å«è¯­éŸ³å†…å®¹**ï¼Œä¸åŒ…å«å±å¹•æ–‡å­—ã€éŸ³æ•ˆæè¿°ç­‰ã€‚å¦‚æœå½“å‰ç”»é¢æ²¡æœ‰å¯è½¬å½•çš„å£è¯­è¯­éŸ³ï¼Œæ­¤å­—æ®µåº”ä¸ºç©ºå­—ç¬¦ä¸²`\"\"`ã€‚ -   `visual_context`: å¯¹å½“å‰å­—å¹•å‡ºç°æ—¶ç”»é¢çš„**å…·ä½“ã€è¯¦ç»†è§†è§‰æè¿°**ã€‚åŒ…æ‹¬äººç‰©åŠ¨ä½œã€è¡¨æƒ…ã€ç‰©ä½“ä½ç½®ã€ç”»é¢ç„¦ç‚¹ã€è‰²å½©æ°›å›´ï¼Œä»¥åŠä»»ä½•**é‡è¦çš„éè¯­éŸ³å¬è§‰ä¿¡æ¯**ï¼ˆå¦‚\"[èƒŒæ™¯éŸ³ä¹]\",\" [æŒå£°]\"ç­‰ï¼‰ï¼Œä»¥å¸®åŠ©ç†è§£åœºæ™¯ã€‚ -   `scene_type`: å½“å‰ç”»é¢æ®µçš„åœºæ™¯ç±»å‹ã€‚ä¾‹å¦‚ï¼š`intro_speech` (å¼€åœºè®²è¯), `product_demo` (äº§å“æ¼”ç¤º), `explanation` (è§£è¯´), `conclusion` (æ€»ç»“), `transition` (è½¬åœº), `on_screen_text_display` (å±å¹•æ–‡å­—é›†ä¸­å±•ç¤º) ç­‰ã€‚ -   `subtitle_zone_suggestion`: **æ¨èå£è¯­å­—å¹•æ˜¾ç¤ºä½ç½®**ã€‚å¦‚`bottom_center` (åº•éƒ¨å±…ä¸­), `top_left` (å·¦ä¸Š), `center_right` (å³ä¸­) ç­‰ã€‚å¦‚æœ`text`ä¸ºç©ºï¼Œä¸”ç”»é¢å·²æœ‰å¤§é‡æ–‡å­—æˆ–ä¸é€‚åˆæ˜¾ç¤ºå­—å¹•ï¼Œå¯æ¨è`\"none\"`ã€‚ -   `visual_complexity`: å½“å‰ç”»é¢çš„è§†è§‰å¤æ‚åº¦ã€‚`low` (ç®€æ´ï¼Œå˜åŒ–å°‘), `medium` (æœ‰ä¸€å®šå…ƒç´ æˆ–åŠ¨æ€), `high` (å…ƒç´ å¤šï¼ŒåŠ¨æ€å‰§çƒˆï¼ŒèƒŒæ™¯å¤æ‚)ã€‚è¿™ä¼šå½±å“å£è¯­å­—å¹•çš„é˜…è¯»æ€§ã€‚ -   `on_screen_obstacles`: **ç”»é¢ä¸­å·²æœ‰çš„ã€å¯èƒ½ä¸å£è¯­å­—å¹•åŒºåŸŸå†²çªçš„è§†è§‰å…ƒç´ æˆ–åŠ¨æ€**ã€‚ä¾‹å¦‚ï¼š`å³ä¸‹è§’æ°´å°`ã€`ç”»é¢ä¸­å¤®äº§å“åç§°æ–‡å­—`ã€`äººç‰©å¤´éƒ¨`ã€`å¿«é€Ÿç§»åŠ¨ç‰©ä½“`ç­‰ã€‚è¿™æ˜¯ç¡®ä¿å£è¯­å­—å¹•â€œæ­£å¸¸æ˜¾ç¤ºâ€çš„å…³é”®ã€‚ -   `on_screen_text_content`: **ç”»é¢ä¸­æ˜¾ç¤ºçš„ä»»ä½•é‡è¦æ–‡å­—å†…å®¹**ï¼ˆå¦‚æ ‡é¢˜ã€Logoæ–‡å­—ã€ä¸»æŒäººå§“åæ¡ã€äº§å“åŠŸèƒ½ä»‹ç»ã€å›¾è¡¨æ–‡å­—ç­‰ï¼‰ã€‚å¦‚æœç”»é¢ä¸­æ²¡æœ‰æ­¤ç±»æ–‡å­—ï¼Œæ­¤å­—æ®µåº”ä¸ºç©ºå­—ç¬¦ä¸²`\"\"`ã€‚ -   `is_inferred_speech`: å¸ƒå°”å€¼ï¼Œå¦‚æœ`text`æ˜¯æ ¹æ®ç”»é¢ï¼ˆå¦‚å£å‹ã€æƒ…å¢ƒï¼‰**æ¨æ–­å‡ºçš„è¯­éŸ³å†…å®¹**ï¼Œåˆ™ä¸º`true`ï¼›å¦‚æœæœ‰å®é™…çš„éŸ³é¢‘æºè¿›è¡Œè½¬å½•ï¼Œåˆ™ä¸º`false`ã€‚",
              "type": "string"
            },
            {
              "id": "39577277-c5cf-432f-9978-475b78d606a4",
              "name": "rh-api-key",
              "value": "",
              "type": "string"
            },
            {
              "id": "b6aeaaf8-7faa-40d2-8b58-ea11d56b30c2",
              "name": "rhæ–‡ç”Ÿå›¾å·¥ä½œæµ",
              "value": "1968571302049140738",
              "type": "string"
            },
            {
              "id": "7234a303-b5b1-4437-a5a3-e3b9db952aa6",
              "name": "rhå›¾ç”Ÿè§†é¢‘å·¥ä½œæµ",
              "value": "1968577373975261186",
              "type": "string"
            },
            {
              "id": "e269d5fc-f836-469d-891f-1767d7e41dd0",
              "name": "rh-url",
              "value": "www.runninghub.cn",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1008,
        416
      ],
      "id": "890a7198-ba1f-45e9-98d2-4c6b854a0c2e",
      "name": "ä¸»è¦è®¾ç½®å‚æ•°"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://www.runninghub.cn/task/openapi/create",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Host",
              "value": "www.runninghub.cn"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"apiKey\": \"{{ $('On form submission').item.json['rh-key'] }}\",\n  \"workflowId\": \"{{ $('ä¸»è¦è®¾ç½®å‚æ•°').item.json['rhæ–‡ç”Ÿå›¾å·¥ä½œæµ'] }}\",\n  \"nodeInfoList\": [\n    {\n      \"nodeId\": \"6\",\n      \"fieldName\": \"text\",\n      \"fieldValue\": \"{{ $json.chinese_prompt }}\"\n    },\n    {\n      \"nodeId\": \"58\",\n      \"fieldName\": \"width\",\n      \"fieldValue\": \"720\"\n    },\n    {\n      \"nodeId\": \"58\",\n      \"fieldName\": \"height\",\n      \"fieldValue\": \"1280\"\n    }\n  ]\n}",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        800,
        624
      ],
      "id": "ec68d25d-47c7-4821-a4e9-a4a282eac2a2",
      "name": "RHæ–‡ç”Ÿå›¾"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://www.runninghub.cn/task/openapi/status",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Host",
              "value": "www.runninghub.cn"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "apiKey",
              "value": "={{ $('On form submission').item.json['rh-key'] }}"
            },
            {
              "name": "taskId",
              "value": "={{ $('RHæ–‡ç”Ÿå›¾').item.json.data.taskId }}"
            }
          ]
        },
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1024,
        480
      ],
      "id": "0120b969-03a7-4434-bc94-c2d8d4641d7d",
      "name": "æ–‡ç”Ÿå›¾çŠ¶æ€æŸ¥è¯¢"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://www.runninghub.cn/task/openapi/outputs",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Host",
              "value": "www.runninghub.cn"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "apiKey",
              "value": "={{ $('On form submission').item.json['rh-key'] }}"
            },
            {
              "name": "taskId",
              "value": "={{ $('RHæ–‡ç”Ÿå›¾').item.json.data.taskId }}"
            }
          ]
        },
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        800,
        144
      ],
      "id": "095e75eb-e0c9-43a6-a022-832b6b52d7a6",
      "name": "è·å–æ–‡ç”Ÿå›¾ç»“æœ"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://www.runninghub.cn/task/openapi/upload",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Host",
              "value": "www.runninghub.cn"
            }
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "apiKey",
              "value": "={{ $('On form submission').item.json[\"rh-key\"] }}"
            },
            {
              "name": "fileType",
              "value": "image"
            },
            {
              "parameterType": "formBinaryData",
              "name": "file",
              "inputDataFieldName": "data"
            }
          ]
        },
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1248,
        144
      ],
      "id": "77467500-61e5-40fc-9e78-ce9e17be8c8a",
      "name": "ä¸Šä¼ æ–‡ç”Ÿå›¾ç»“æœåˆ°RH"
    },
    {
      "parameters": {
        "url": "={{ $json.data[0].fileUrl }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1024,
        144
      ],
      "id": "747c555f-7b62-49e1-a155-7cbd98bd6492",
      "name": "ä¸‹è½½æ–‡ç”Ÿå›¾ç»“æœ"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://www.runninghub.cn/task/openapi/create",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Host",
              "value": "www.runninghub.cn"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"apiKey\": \"{{ $('On form submission').item.json['rh-key'] }}\",\n  \"workflowId\": \"{{ $('ä¸»è¦è®¾ç½®å‚æ•°').item.json['rhå›¾ç”Ÿè§†é¢‘å·¥ä½œæµ'] }}\",\n  \"nodeInfoList\": [\n    {\n      \"nodeId\": \"16\",\n      \"fieldName\": \"positive_prompt\",\n      \"fieldValue\": \"{{ $json['è§†é¢‘æç¤ºè¯'] }}\"\n    },\n    {\n      \"nodeId\": \"68\",\n      \"fieldName\": \"width\",\n      \"fieldValue\": \"480\"\n    },\n    {\n      \"nodeId\": \"68\",\n      \"fieldName\": \"height\",\n      \"fieldValue\": \"832\"\n    },\n    {\n      \"nodeId\": \"67\",\n      \"fieldName\": \"image\",\n      \"fieldValue\": \"{{ $('ä¸Šä¼ æ–‡ç”Ÿå›¾ç»“æœåˆ°RH').item.json.data.fileName }}\"\n    }\n  ]\n}",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1184,
        1056
      ],
      "id": "281add82-6d69-4f1e-b6c3-b90ad6eff701",
      "name": "å›¾ç”Ÿè§†é¢‘å·¥ä½œæµ"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://www.runninghub.cn/task/openapi/status",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Host",
              "value": "www.runninghub.cn"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "apiKey",
              "value": "={{ $('On form submission').item.json['rh-key'] }}"
            },
            {
              "name": "taskId",
              "value": "={{ $('å›¾ç”Ÿè§†é¢‘å·¥ä½œæµ').item.json.data.taskId }}"
            }
          ]
        },
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -960,
        1056
      ],
      "id": "5e7a92e4-2bbc-481e-92d6-25476ed132e0",
      "name": "å›¾ç”Ÿè§†é¢‘çŠ¶æ€æŸ¥è¯¢"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://www.runninghub.cn/task/openapi/outputs",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Host",
              "value": "www.runninghub.cn"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "apiKey",
              "value": "{{ $('On form submission').item.json['rh-key'] }}"
            },
            {
              "name": "taskId",
              "value": "={{ $('å›¾ç”Ÿè§†é¢‘å·¥ä½œæµ').item.json.data.taskId }}"
            }
          ]
        },
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -512,
        928
      ],
      "id": "5559cbc0-498f-42eb-9724-8943f5dcd437",
      "name": "è·å–å›¾ç”Ÿè§†é¢‘ç»“æœ"
    },
    {
      "parameters": {
        "url": "={{ $json.data[0].fileUrl }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -288,
        928
      ],
      "id": "f0b65b9e-1267-4f8a-b57c-039c455696dc",
      "name": "ä¸‹è½½è§†é¢‘"
    },
    {
      "parameters": {
        "content": "# 5ç”ŸæˆéŸ³é¢‘",
        "height": 848,
        "width": 3136
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1936,
        1568
      ],
      "typeVersion": 1,
      "id": "d06a99a4-7f7b-485b-8995-a5478bfaf41a",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://www.runninghub.cn/task/openapi/upload",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Host",
              "value": "www.runninghub.cn"
            }
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "apiKey",
              "value": "={{ $('On form submission').item.json['rh-key'] }}"
            },
            {
              "name": "fileType",
              "value": "image"
            },
            {
              "parameterType": "formBinaryData",
              "name": "file",
              "inputDataFieldName": "data"
            }
          ]
        },
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1392,
        2128
      ],
      "id": "fe88c7a0-845b-449a-ac28-0bc508071a1c",
      "name": "ä¸Šä¼ é…éŸ³åˆ°RH"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://www.runninghub.cn/task/openapi/create",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Host",
              "value": "www.runninghub.cn"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"apiKey\": \"{{ $('On form submission').item.json['rh-key'] }}\",\n  \"workflowId\": \"1968602119202906113\",\n  \"nodeInfoList\": [\n    {\n      \"nodeId\": \"11\",\n      \"fieldName\": \"audio\",\n      \"fieldValue\": \"{{ $('ä¸Šä¼ é…éŸ³åˆ°RH').item.json.data.fileName }}\"\n    },\n    {\n      \"nodeId\": \"14\",\n      \"fieldName\": \"multi_line_prompt\",\n      \"fieldValue\": \"{{ $('è®¾ç½®å‚æ•°-æ—ç™½-éŸ³ç”»åŒæ­¥1').item.json['æ—ç™½'].narration_v1 }}\"\n    },\n    {\n      \"nodeId\": \"211\",\n      \"fieldName\": \"multi_line_prompt\",\n      \"fieldValue\": \"{{ $('è®¾ç½®å‚æ•°-æ—ç™½-éŸ³ç”»åŒæ­¥1').item.json['æ—ç™½'].narration_v2 }}\"\n    },\n    {\n      \"nodeId\": \"41\",\n      \"fieldName\": \"multi_line_prompt\",\n      \"fieldValue\": \"{{ $('è®¾ç½®å‚æ•°-æ—ç™½-éŸ³ç”»åŒæ­¥1').item.json['æ—ç™½'].narration_v3 }}\"\n    }\n  ]\n}",
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1168,
        2128
      ],
      "id": "66940898-9a16-4239-a83e-acc83aff07e5",
      "name": "è¿è¡ŒéŸ³é¢‘ç”Ÿæˆ"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://www.runninghub.cn/task/openapi/status",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Host",
              "value": "www.runninghub.cn"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "apiKey",
              "value": "={{ $('On form submission').item.json['rh-key'] }}"
            },
            {
              "name": "taskId",
              "value": "={{ $('è¿è¡ŒéŸ³é¢‘ç”Ÿæˆ').item.json.data.taskId }}"
            }
          ]
        },
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -944,
        2128
      ],
      "id": "26b942b7-1bff-42bc-a265-6bae2ffd9de6",
      "name": "æŸ¥è¯¢éŸ³é¢‘ç”ŸæˆçŠ¶æ€"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://www.runninghub.cn/task/openapi/outputs",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Host",
              "value": "www.runninghub.cn"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "apiKey",
              "value": "={{ $('On form submission').item.json['rh-key'] }}"
            },
            {
              "name": "taskId",
              "value": "={{ $('è¿è¡ŒéŸ³é¢‘ç”Ÿæˆ').item.json.data.taskId }}"
            }
          ]
        },
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -496,
        2000
      ],
      "id": "360b1a8e-1f29-49cb-b435-d0923743dbc3",
      "name": "è·å–é…éŸ³ç»“æœ"
    },
    {
      "parameters": {
        "content": "# ğŸ’– è€ä½•çš„AIGCç ”ç©¶å®¤ ğŸ’–\n\n## å˜¿ï¼æœ‰AIGCæ–¹é¢çš„é—®é¢˜å—ï¼Ÿæ‰¾æˆ‘å°±å¯¹å•¦ï¼ğŸ‘‡\n\n## ğŸ–¥ï¸ æä¸å®šè¿œç¨‹ç¯å¢ƒï¼Ÿæˆ‘æ¥å¸®ä½ éƒ¨ç½²ï¼\n\n## ğŸ é‡åˆ°æŠ¥é”™ï¼Ÿåˆ«æ‹…å¿ƒï¼Œæˆ‘èƒ½å¸®ä½ ä¿®å¤ï¼\n\n## â“ æœ‰ç–‘é—®ï¼Ÿä¸€å¯¹ä¸€ä¸“å±ç­”ç–‘ç­‰ä½ å“¦ï¼\n\n## ğŸš€ éœ€è¦çš„è¯ï¼Œå¿«æ¥è”ç³»æˆ‘å§ï¼\n\n*   å¾®ä¿¡: **hlsaigc**\n*   [ç‚¹å‡»è”ç³»æˆ‘çš„Telegram](https://t.me/hegenai)\n*   [æˆ‘çš„Bç«™ä¸»é¡µ](https://space.bilibili.com/1313066)\n*   [æˆ‘çš„YouTubeé¢‘é“](https://www.youtube.com/@lunare-mcn)\n",
        "height": 576,
        "width": 832,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2192,
        96
      ],
      "typeVersion": 1,
      "id": "b0ebf79c-6e6e-4237-b9fc-6840bd3b656a",
      "name": "Sticky Note7"
    },
    {
      "parameters": {
        "content": "# è€ä½•çš„AIGCç ”ç©¶å®¤\n# è‡ªåŠ¨ç”Ÿæˆçˆ†æ¬¾çŸ­è§†é¢‘åŠæ—ç™½ éŸ³ç”»åŒæ­¥å­—å¹•ç‰ˆ QWEN ç‰¹ä¼˜åŒ–ç‰ˆ\n# RHè¿è¡Œç‰ˆ",
        "height": 192,
        "width": 2064
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2176,
        -128
      ],
      "typeVersion": 1,
      "id": "e27d77d3-30d4-4d51-8f3e-33fed61a3847",
      "name": "Sticky Note8"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "3cd17b21-e0bf-4dde-b308-c27d35155ef8",
              "name": "video_title_chinese",
              "value": "={{ $json.video_title_chinese }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -272,
        624
      ],
      "id": "e85d9c66-ebac-4d9d-bb9a-1607d8da2687",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -464,
        3456
      ],
      "id": "451a3740-52f2-4d19-9318-a205458b66b4",
      "name": "Merge4"
    }
  ],
  "pinData": {},
  "connections": {
    "On form submission": {
      "main": [
        [
          {
            "node": "ä¸»è¦è®¾ç½®å‚æ•°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Split Out1": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Split Out1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [
          {
            "node": "26-è¯»å–ç”Ÿæˆçš„è§†é¢‘ç”¨äºåˆå¹¶1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "RHæ–‡ç”Ÿå›¾",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If2": {
      "main": [
        [
          {
            "node": "è·å–æ–‡ç”Ÿå›¾ç»“æœ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait1": {
      "main": [
        [
          {
            "node": "æ–‡ç”Ÿå›¾çŠ¶æ€æŸ¥è¯¢",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§†é¢‘æç¤ºè¯-å›¾ç‰‡åŠ¨æ€è§†é¢‘": {
      "main": [
        [
          {
            "node": "è®¾ç½®å‚æ•°-è§†é¢‘æç¤ºè¯",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è®¾ç½®å‚æ•°-è§†é¢‘æç¤ºè¯": {
      "main": [
        [
          {
            "node": "å›¾ç”Ÿè§†é¢‘å·¥ä½œæµ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model3": {
      "ai_languageModel": [
        [
          {
            "node": "è§†é¢‘æç¤ºè¯-å›¾ç‰‡åŠ¨æ€è§†é¢‘",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "If3": {
      "main": [
        [
          {
            "node": "è·å–å›¾ç”Ÿè§†é¢‘ç»“æœ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait2": {
      "main": [
        [
          {
            "node": "å›¾ç”Ÿè§†é¢‘çŠ¶æ€æŸ¥è¯¢",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è®¾ç½®å‚æ•°-æ—ç™½-éŸ³ç”»åŒæ­¥1": {
      "main": [
        [
          {
            "node": "Read/Write Files from Disk5",
            "type": "main",
            "index": 0
          },
          {
            "node": "8.2-æŒ‰æ—¥æœŸå»ºç«‹æ–‡ä»¶å¤¹1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload a file": {
      "main": [
        [
          {
            "node": "è®¾ç½®å‚æ•°-éŸ³ç”»åŒæ­¥æç¤ºè¯",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è®¾ç½®å‚æ•°-éŸ³ç”»åŒæ­¥æç¤ºè¯": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read/Write Files from Disk3": {
      "main": [
        [
          {
            "node": "FFprobe3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge2": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "FFprobe3": {
      "main": [
        [
          {
            "node": "è·å–è§†é¢‘æ—¶é•¿",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "8.2-æŒ‰æ—¥æœŸå»ºç«‹æ–‡ä»¶å¤¹1": {
      "main": [
        [
          {
            "node": "Merge3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If4": {
      "main": [
        [
          {
            "node": "è®¾ç½®å‚æ•°-æ—ç™½-éŸ³ç”»åŒæ­¥1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge3": {
      "main": [
        [
          {
            "node": "Read/Write Files from Disk3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Execute Command2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execute Command2": {
      "main": [
        [
          {
            "node": "Execute Command3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "26-è¯»å–ç”Ÿæˆçš„è§†é¢‘ç”¨äºåˆå¹¶1": {
      "main": [
        [
          {
            "node": "27-åˆ¶ä½œåˆå¹¶åˆ—è¡¨1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "27-åˆ¶ä½œåˆå¹¶åˆ—è¡¨1": {
      "main": [
        [
          {
            "node": "28-åˆå¹¶åˆ—è¡¨è½¬æ¢ä¸ºTXTæ–‡ä»¶1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "28-åˆå¹¶åˆ—è¡¨è½¬æ¢ä¸ºTXTæ–‡ä»¶1": {
      "main": [
        [
          {
            "node": "Merge4",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "29-å‚¨å­˜åˆå¹¶åˆ—è¡¨1": {
      "main": [
        [
          {
            "node": "30-è§†é¢‘æ‹¼æ¥åˆæˆ1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "FFprobe4": {
      "main": [
        [
          {
            "node": "Read/Write Files from Disk6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "If4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è®¾ç½®å‚æ•°-æå–æç¤ºè¯1": {
      "main": [
        [
          {
            "node": "éå†1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "éå†1": {
      "main": [
        [
          {
            "node": "Code1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§†é¢‘åˆ†æ1": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read/Write Files from Disk6": {
      "main": [
        [
          {
            "node": "Upload a file2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload a file2": {
      "main": [
        [
          {
            "node": "è§†é¢‘åˆ†æ1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code1": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "è®¾ç½®å‚æ•°-æå–æç¤ºè¯1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execute Command3": {
      "main": [
        [
          {
            "node": "FFprobe4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait": {
      "main": [
        [
          {
            "node": "è§†é¢‘åˆ†æ1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Execute Command",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execute Command": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge1": {
      "main": [
        [
          {
            "node": "è§†é¢‘æç¤ºè¯-å›¾ç‰‡åŠ¨æ€è§†é¢‘",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read/Write Files from Disk5": {
      "main": [
        [
          {
            "node": "ä¸Šä¼ é…éŸ³åˆ°RH",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request18": {
      "main": [
        [
          {
            "node": "Read/Write Files from Disk4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request19": {
      "main": [
        [
          {
            "node": "Read/Write Files from Disk7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request20": {
      "main": [
        [
          {
            "node": "Read/Write Files from Disk8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read/Write Files from Disk4": {
      "main": [
        [
          {
            "node": "FFprobe5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "FFprobe5": {
      "main": [
        [
          {
            "node": "å£°éŸ³æ—¶é•¿-1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read/Write Files from Disk7": {
      "main": [
        [
          {
            "node": "FFprobe6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "FFprobe6": {
      "main": [
        [
          {
            "node": "å£°éŸ³æ—¶é•¿-2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read/Write Files from Disk8": {
      "main": [
        [
          {
            "node": "FFprobe7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "FFprobe7": {
      "main": [
        [
          {
            "node": "å£°éŸ³æ—¶é•¿-3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "è·å–é…éŸ³ç»“æœ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "HTTP Request18",
            "type": "main",
            "index": 0
          },
          {
            "node": "HTTP Request19",
            "type": "main",
            "index": 0
          },
          {
            "node": "HTTP Request20",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait3": {
      "main": [
        [
          {
            "node": "æŸ¥è¯¢éŸ³é¢‘ç”ŸæˆçŠ¶æ€",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è·å–è§†é¢‘æ—¶é•¿": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 3
          }
        ]
      ]
    },
    "å£°éŸ³æ—¶é•¿-1": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å£°éŸ³æ—¶é•¿-2": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "å£°éŸ³æ—¶é•¿-3": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "ä¸»è¦è®¾ç½®å‚æ•°": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RHæ–‡ç”Ÿå›¾": {
      "main": [
        [
          {
            "node": "æ–‡ç”Ÿå›¾çŠ¶æ€æŸ¥è¯¢",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ–‡ç”Ÿå›¾çŠ¶æ€æŸ¥è¯¢": {
      "main": [
        [
          {
            "node": "If2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è·å–æ–‡ç”Ÿå›¾ç»“æœ": {
      "main": [
        [
          {
            "node": "ä¸‹è½½æ–‡ç”Ÿå›¾ç»“æœ",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¸Šä¼ æ–‡ç”Ÿå›¾ç»“æœåˆ°RH": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "ä¸‹è½½æ–‡ç”Ÿå›¾ç»“æœ": {
      "main": [
        [
          {
            "node": "ä¸Šä¼ æ–‡ç”Ÿå›¾ç»“æœåˆ°RH",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å›¾ç”Ÿè§†é¢‘å·¥ä½œæµ": {
      "main": [
        [
          {
            "node": "å›¾ç”Ÿè§†é¢‘çŠ¶æ€æŸ¥è¯¢",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å›¾ç”Ÿè§†é¢‘çŠ¶æ€æŸ¥è¯¢": {
      "main": [
        [
          {
            "node": "If3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è·å–å›¾ç”Ÿè§†é¢‘ç»“æœ": {
      "main": [
        [
          {
            "node": "ä¸‹è½½è§†é¢‘",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¸‹è½½è§†é¢‘": {
      "main": [
        [
          {
            "node": "Upload a file",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge3",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "ä¸Šä¼ é…éŸ³åˆ°RH": {
      "main": [
        [
          {
            "node": "è¿è¡ŒéŸ³é¢‘ç”Ÿæˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¿è¡ŒéŸ³é¢‘ç”Ÿæˆ": {
      "main": [
        [
          {
            "node": "æŸ¥è¯¢éŸ³é¢‘ç”ŸæˆçŠ¶æ€",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æŸ¥è¯¢éŸ³é¢‘ç”ŸæˆçŠ¶æ€": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è·å–é…éŸ³ç»“æœ": {
      "main": [
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Merge4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge4": {
      "main": [
        [
          {
            "node": "29-å‚¨å­˜åˆå¹¶åˆ—è¡¨1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "timezone": "Asia/Shanghai",
    "callerPolicy": "workflowsFromSameOwner"
  },
  "versionId": "e36dd37d-076b-49ba-bf03-82d447451709",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "b0b7f87d6f0ab5201cdbcbf210faac2d8aaa058712bb43e124d326b223e72f49"
  },
  "id": "8qKPFNF6hFE1WfH2",
  "tags": []
}

